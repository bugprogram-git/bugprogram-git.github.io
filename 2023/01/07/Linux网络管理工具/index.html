<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="Linux网络管理工具, MyBlog">
    <meta name="description" content="Linux网络管理工具1.systemd-networkdsystemd自带的网络管理工具，一般仅用于有线网卡的网络配置或者是不需要验证的无线网络配置
1.描述网络配置的操作由 systemd-networkd.service(8) 执行。">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->

<script async src="https://www.googletagmanager.com/gtag/js?id="></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());
    gtag('config', '');
</script>


    <title>Linux网络管理工具 | MyBlog</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    


    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    
        <link rel="stylesheet" type="text/css" href="/css/reward.css">
    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 7.2.0"><link rel="alternate" href="/atom.xml" title="MyBlog" type="application/atom+xml">
</head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">MyBlog</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
  <li>
    <a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式" >
      <i id="sum-moon-icon" class="fas fa-sun" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">MyBlog</div>
        <div class="logo-desc">
            
            myblog
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/blinkfox/hexo-theme-matery" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/blinkfox/hexo-theme-matery" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/2.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">Linux网络管理工具</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                          <div class="article-tag">
                            <span class="chip bg-color">无标签</span>
                          </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2023-01-07
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp;
                    2024-04-21
                </div>
                

                

                

                
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.min.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="Linux网络管理工具"><a href="#Linux网络管理工具" class="headerlink" title="Linux网络管理工具"></a>Linux网络管理工具</h1><h2 id="1-systemd-networkd"><a href="#1-systemd-networkd" class="headerlink" title="1.systemd-networkd"></a>1.systemd-networkd</h2><p>systemd自带的网络管理工具，一般仅用于有线网卡的网络配置或者是不需要验证的无线网络配置</p>
<h4 id="1-描述"><a href="#1-描述" class="headerlink" title="1.描述"></a>1.描述</h4><p>网络配置的操作由 <a target="_blank" rel="noopener" href="http://www.jinbuguo.com/systemd/systemd-networkd.service.html#">systemd-networkd.service(8)</a> 执行。<br>注意，网络设备的Network文件必须以 <code>.network</code> 作为后缀名，否则将被忽略。 一旦与Network文件匹配的网卡出现，对应的Network文件就会立即生效。</p>
<p>Network文件分别位于： 系统网络目录(<code>/usr/lib/systemd/network</code>)、 运行时网络目录(<code>/run/systemd/network</code>)、 本机网络目录(<code>/etc/systemd/network</code>)。 所有的Network文件(无论位于哪个目录中)，统一按照文件名的字典顺序处理。 对于不同目录下的同名Network文件，仅以优先级最高的目录中的那一个为准。 具体说来就是：<code>/etc/</code> 的优先级最高、 <code>/run/</code> 的优先级居中、<code>/usr/lib/</code> 的优先级最低。 如果系统管理员想要屏蔽 <code>/usr/lib/</code> 目录中的某个Network文件， 那么最佳做法是在 <code>/etc/</code> 目录中创建一个指向 <code>/dev/null</code> 的同名符号链接， 即可彻底屏蔽 <code>/usr/lib/</code> 目录中的同名文件。</p>
<p>对于例如 <code>foo.network</code> 这样的Network文件，可以同时存在对应的 <code>foo.network.d/</code> 目录，当解析完Network文件之后，目录中所有以 “<code>.conf</code>“ 结尾的文件，都会被按照文件名的字典顺序，依次解析(相当于依次附加到Network文件的末尾)。 这样就可以方便的修改Network文件，或者为Network文件添加额外的设置，而无需修改Network文件本身。 注意，所有配置片段(“<code>.conf</code>“ 文件)必须包含明确的小节头(例如 “<code>[Match]</code>“ 之类)。</p>
<p>“<code>.d</code>“ 目录除了可以放置在 <code>/etc/systemd/network</code> 目录中， 还可以放置在 <code>/usr/lib/systemd/network</code> 与 <code>/run/systemd/network</code> 目录中。 所有 “<code>.d/</code>“ 目录中的配置片段都会覆盖Network文件的设置(无论Network文件位于哪个目录)。 虽然在优先级上，<code>/etc</code> 中的配置片段优先级最高、 <code>/run</code> 中的配置片段优先级居中、<code>/usr/lib</code> 中的配置片段优先级最低。 但是由于 <code>/run</code> 是临时目录，而 <code>/usr/lib</code> 仅供软件包使用， 所以在实践中，”<code>.d/</code>“ 目录仅会放置在 <code>/etc/systemd/network</code> 目录中。</p>
<p>注意，如果某个网络接口既没有配置静态IPv6地址、也没有启用DHCPv6或IPv6LL的话， 将会被视为禁用IPv6支持。同时，systemd 将会自动向 <code>/proc/sys/net/ipv6/conf/_`ifname`_/disable_ipv6</code> 中写入”1”，以彻底禁用此接口上的IPv6支持。</p>
<h4 id="2-配置选项"><a href="#2-配置选项" class="headerlink" title="2.配置选项"></a>2.配置选项</h4><h5 id="1-Match"><a href="#1-Match" class="headerlink" title="1.Match"></a>1.Match</h5><p>Network文件中的Match选项用于描述需要配置的网卡的指定信息，如果同一块网卡有多个network文件，则以第一个匹配的文件配置信息为准。</p>
<h6 id="Name"><a href="#Name" class="headerlink" title="Name"></a>Name</h6><p>网卡的名称(网卡内核中INTERFACE的属性值)<br>匹配网卡的 “<code>INTERFACE</code>“ 属性值(网卡的内核名称)。 </p>
<h6 id="MACAddress"><a href="#MACAddress" class="headerlink" title="MACAddress"></a>MACAddress</h6><p>匹配网卡的物理地址。接受一个空白符分隔的MAC地址列表。 每个MAC地址都以冒号(:)、连字符(-)、句点(.)分隔的十六进制数表示(参见下例)。 可以多次使用此选项，表示融合多个列表。设为空字符串表示清空先前已经设置的列表。<br>例子：MACAddress&#x3D;01:23:45:67:89:ab 00-11-22-33-44-55 AABB.CCDD.EEFF</p>
<h6 id="Driver"><a href="#Driver" class="headerlink" title="Driver"></a>Driver</h6><p>匹配网卡的 “<code>DRIVER</code>“ 属性值(网卡的驱动名称)。 接收一个空格分隔的匹配模式列表(使用shell风格的通配符)。 注意，如果网卡的 “<code>DRIVER</code>“ 属性不存在， 那么将使用 “<code>ethtool -i</code>“ 命令中输出的驱动名称。 可以在列表前加上”!”前缀 表示反转。</p>
<h6 id="Host"><a href="#Host" class="headerlink" title="Host"></a>Host</h6><p>匹配系统的主机名(hostname)或”machine ID”， 参见 <a target="_blank" rel="noopener" href="http://www.jinbuguo.com/systemd/systemd.unit.html#">systemd.unit(5)</a> 中的 “<code>ConditionHost=</code>“ 选项。</p>
<h5 id="2-Link"><a href="#2-Link" class="headerlink" title="2.Link"></a>2.Link</h5><p>可在 “<code>[Link]</code>“ 小节中使用如下选项对网卡进行设置：</p>
<h6 id="MACAddress-1"><a href="#MACAddress-1" class="headerlink" title="MACAddress"></a>MACAddress</h6><p>设置网卡的物理地址(MAC地址)</p>
<h6 id="MTUBytes"><a href="#MTUBytes" class="headerlink" title="MTUBytes"></a>MTUBytes</h6><p>设置网卡的最大传输单元(MTU)。 可以使用 以1024为基准的 K, M, G 后缀。</p>
<p>注意，如果为网卡开启了IPv6支持， 那么设置任何小于 1280 的值都将被自动修正为 1280(IPv6的MTU最小值)。</p>
<h6 id="ARP"><a href="#ARP" class="headerlink" title="ARP"></a>ARP</h6><p>接受一个布尔值。表示是否开启 ARP(Address Resolution Protocol) 支持。 若未设置此选项，则使用内核的默认值。</p>
<p>当在单个底层物理网卡上创建多个虚拟 MACVLAN 或 VLAN 设备时， 禁用ARP就非常有用了。 因为此时的底层物理网卡仅用于汇聚流量， 而并不参与任何网络操作。</p>
<h6 id="Multicast"><a href="#Multicast" class="headerlink" title="Multicast"></a>Multicast</h6><p>接受一个布尔值。表示是否开启设备的多播标记。</p>
<h6 id="AllMulticast"><a href="#AllMulticast" class="headerlink" title="AllMulticast"></a>AllMulticast</h6><p>接受一个布尔值。表示驱动程序是否从网络提取所有多播数据包。 启用多播路由时将会发生这种情况。</p>
<h6 id="Unmanaged"><a href="#Unmanaged" class="headerlink" title="Unmanaged"></a>Unmanaged</h6><p>接受一个布尔值。 默认值为 “<code>no</code>“ 。 若设为 “<code>yes</code>“ 则表示不使用 systemd 管理此设备， 在效果上相当于没有匹配到此设备。</p>
<p>当你希望 使用 systemd 之外的其他程序来管理网络设备时， 可以使用此选项。</p>
<h6 id="RequiredForOnline"><a href="#RequiredForOnline" class="headerlink" title="RequiredForOnline"></a>RequiredForOnline</h6><p>接受一个布尔值。默认值 “<code>yes</code>“ 表示当 “<code>systemd-networkd-wait-online</code>“ 检查网络是否在线时， 此网络必须在线(否则一直等到它在线)。 设为 “<code>no</code>“ 表示 忽略此网络(不检查此网络的状态)。</p>
<p>无论此选项如何设置，都会正常启动此网络。 只不过当 “<code>RequiredForOnline=no</code>“ 时， 如果此网络不在线(例如未能从 DHCP 获取IP地址、或者网线被拔出等原因)， 那么 “<code>systemd-networkd-wait-online</code>“ 将会自动跳过它。</p>
<h5 id="3-Network"><a href="#3-Network" class="headerlink" title="3.Network"></a>3.Network</h5><p>可在 “<code>[Network]</code>“ 小节中使用如下选项对网卡进行设置：</p>
<h6 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h6><p>对网卡的 描述</p>
<h6 id="DHCP"><a href="#DHCP" class="headerlink" title="DHCP"></a>DHCP</h6><p>DHCPv4&#x2F;DHCPv6 客户端支持。可以设为 “<code>yes</code>“, “<code>no</code>“, “<code>ipv4</code>“, “<code>ipv6</code>“ 之一。默认值为 “<code>no</code>“ 。</p>
<p>注意，当 “<code>IPv6AcceptRA=yes</code>“ 时， 无论此选项如何设置，DHCPv6 都将被无条件的启用。 若明确开启了 DHCPv6 支持， 那么无论在此连接上是否存在路由器、也无论路由器传递了什么样的标记(flag)， 都会无条件的启动 DHCPv6 客户端。参见下文的 “<code>IPv6AcceptRA=</code>“ 选项。</p>
<p>注意，默认情况下， DHCP服务器分配的域名并不用于名字解析。 参见下面的 <code>UseDomains=</code> 选项。</p>
<p>参见下面的 “<code>[DHCP]</code>“ 小节， 以了解更多DHCP客户端配置选项。</p>
<h6 id="DHCPServer"><a href="#DHCPServer" class="headerlink" title="DHCPServer"></a>DHCPServer</h6><p>接受一个布尔值。表示是否在此网络上启动内置的 DHCPv4 服务器。 默认值为 “<code>no</code>“ 。 进一步的设置参见下面的 “<code>[DHCPServer]</code>“ 小节。</p>
<h6 id="LinkLocalAddressing"><a href="#LinkLocalAddressing" class="headerlink" title="LinkLocalAddressing"></a>LinkLocalAddressing</h6><p>链路本地地址自动配置。可设为 “<code>yes</code>“, “<code>no</code>“, “<code>ipv4</code>“, “<code>ipv6</code>“ 之一。 默认值为 “<code>ipv6</code>“</p>
<h6 id="IPv4LLRoute"><a href="#IPv4LLRoute" class="headerlink" title="IPv4LLRoute"></a>IPv4LLRoute</h6><p>接受一个布尔值。表示是否为 non-IPv4LL 主机与 IPv4LL-only 主机之间的通信提供路由支持。默认值是 no 。 [译者注]”IPv4LL”(IPv4 Link-Local)又称为”<a target="_blank" rel="noopener" href="http://www.zeroconf.org/">ZEROCONF</a>“， 可用于在没有DHCP服务器的网络中自动配置IP地址。</p>
<h6 id="IPv6Token"><a href="#IPv6Token" class="headerlink" title="IPv6Token"></a>IPv6Token</h6><p>一个前64位为空的IPv6地址。 用于设置该连接的 SLAAC IPv6 地址的64位接口部分。 注意，该值仅用于 SLAAC 而不是用于 DHCPv6 (即使 IPv6 Router Advertisement 明确要求 DHCP)。 默认值为自动生成。</p>
<h6 id="LLMNR"><a href="#LLMNR" class="headerlink" title="LLMNR"></a>LLMNR</h6><p>接受一个布尔值。默认值 yes 表示支持 本地链路多播名称解析(<a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc4795">Link-Local Multicast Name Resolution</a>)，而 no 则表示关闭。 也可以设为 “<code>resolve</code>“ 表示仅支持解析，但不支持主机注册与宣布。 <a target="_blank" rel="noopener" href="http://www.jinbuguo.com/systemd/systemd-resolved.service.html#">systemd-resolved.service(8)</a> 会读取此选项的值。 [译者注]”LLMNR”(mDNS)可用于在没有DNS的局域网内自动发现(通过组播)本地网段上的主机。</p>
<h6 id="MulticastDNS"><a href="#MulticastDNS" class="headerlink" title="MulticastDNS"></a>MulticastDNS</h6><p>接受一个布尔值。设为 yes 表示支持 组播DNS(<a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc6762">Multicast DNS</a>)，而默认值 no 则表示关闭。 也可以设为 “<code>resolve</code>“ 表示仅支持解析，但不支持主机或服务注册与宣布。 <a target="_blank" rel="noopener" href="http://www.jinbuguo.com/systemd/systemd-resolved.service.html#">systemd-resolved.service(8)</a> 会读取此选项的值。 [译者注]”mDNS”(multicast DNS)可用于在没有DNS的局域网内自动发现(通过组播)本地网段上的主机&#x2F;服务(例如FTP)。</p>
<h6 id="DNSOverTLS"><a href="#DNSOverTLS" class="headerlink" title="DNSOverTLS"></a>DNSOverTLS</h6><p>接受一个布尔值或特殊值 “<code>opportunistic</code>“ 。 设为 yes 表示为此连接开启 <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc7858">DNS-over-TLS</a> 支持。设为 “<code>opportunistic</code>“ 表示优先使用 DNS-over-TLS 但也向下兼容不支持 DNS-over-TLS 的DNS服务器。 此选项实际上是针对每个网口覆盖了 <a target="_blank" rel="noopener" href="http://www.jinbuguo.com/systemd/resolved.conf.html#">resolved.conf(5)</a>‘s 中的全局 <code>DNSOverTLS=</code> 设置。默认值为 no 。 此选项将被 <a target="_blank" rel="noopener" href="http://www.jinbuguo.com/systemd/systemd-resolved.service.html#">systemd-resolved.service(8)</a> 读取。</p>
<h6 id="DNSSEC"><a href="#DNSSEC" class="headerlink" title="DNSSEC"></a>DNSSEC</h6><p>接受一个布尔值或特殊值 “<code>allow-downgrade</code>“ 。设为 yes 表示支持 <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc4033">DNSSEC</a> ，而默认值 no 则表示关闭。 也可以设为 “<code>allow-downgrade</code>“ 表示允许降级到普通的DNS协议， 以兼容不具备DNSSEC的网络环境。 <a target="_blank" rel="noopener" href="http://www.jinbuguo.com/systemd/systemd-resolved.service.html#">systemd-resolved.service(8)</a> 会读取此选项的值。 此选项实际上是针对每个网口覆盖了 <a target="_blank" rel="noopener" href="http://www.jinbuguo.com/systemd/resolved.conf.html#">resolved.conf(5)</a> 中的全局 <code>DNSSEC=</code> 设置。</p>
<h6 id="DNSSECNegativeTrustAnchors"><a href="#DNSSECNegativeTrustAnchors" class="headerlink" title="DNSSECNegativeTrustAnchors"></a>DNSSECNegativeTrustAnchors</h6><p>可设为一个 空格分隔的域名列表。 当通过该网口的DNS服务器查询列表中的域名(含子域名)时， 无需验证应答的正确性。 常用于 禁用某些私有域名的DNSSEC验证。 因为这些私有域名 无法在互联网DNS服务器上进行验证。 默认值为空。 <a target="_blank" rel="noopener" href="http://www.jinbuguo.com/systemd/systemd-resolved.service.html#">systemd-resolved.service(8)</a> 会读取此选项的值。</p>
<h6 id="LLDP"><a href="#LLDP" class="headerlink" title="LLDP"></a>LLDP</h6><p>LLDP是一个二层协议，使得接入网络的一台设备可以将其主要的能力、管理地址、设备标识、接口标识等信息 发送给接入同一个局域网的其他设备。通常只有专业的路由器才会支持LLDP协议。 若设为 yes 则表示接收所有以太网LLDP(链路层发现协议)包，并且维护一个记录了所有LLDP邻居的数据库。 而 no 则表示彻底禁用LLDP支持。 默认值 “<code>routers-only</code>“ 表示仅收集各种路由器LLDP数据， 而忽略所有其他设备的LLDP数据(例如”电话”之类)。 可以用 <a target="_blank" rel="noopener" href="http://www.jinbuguo.com/systemd/networkctl.html#">networkctl(1)</a> 查询所有收集到的邻居数据。LLDP仅可用于以太网。 下面的 <code>EmitLLDP=</code> 可用于接收本机发出的LLDP包。</p>
<h6 id="EmitLLDP"><a href="#EmitLLDP" class="headerlink" title="EmitLLDP"></a>EmitLLDP</h6><p>如何发送以太网链路层发现协议(LLDP)数据包。 可以设为一个布尔值或者特殊值 “<code>nearest-bridge</code>“, “<code>non-tpmr-bridge</code>“, “<code>customer-bridge</code>“ 之一。 默认值 no 表示不发送任何LLDP数据包。 no 之外的其他值都表示周期性的发送包含本机配置信息的LLDP数据包。 LLDP数据包中包含了本机的如下信息：主机名(hostname)、machine ID (参见 <a target="_blank" rel="noopener" href="http://www.jinbuguo.com/systemd/machine-id.html#">machine-id(5)</a>)、 本地网络接口的名称、 pretty 主机名(参见 <a target="_blank" rel="noopener" href="http://www.jinbuguo.com/systemd/machine-info.html#">machine-info(5)</a>)。 LLDP仅可用于以太网链路。 由于LLDP数据包中包含了精确标识主机的敏感信息，所以切勿在不可信的网络环境中使用。 开启此选项之后，其他系统就可以通过本机发送的LLDP数据包，辨别其所连接的本机网络接口究竟是哪一个。 三个特殊值控制着如何传输LLDP数据包： “<code>nearest-bridge</code>“ 表示仅允许传输到最近连接的桥，这是最严苛的传输方式； “<code>non-tpmr-bridge</code>“ 表示仅允许跨越 Two-Port MAC 传输，但是不允许传输到另外的桥； “<code>customer-bridge</code>“ 表示一直传输到到达一个”customer bridge”(详见 <a target="_blank" rel="noopener" href="https://standards.ieee.org/findstds/standard/802.1AB-2016.html">IEEE 802.1AB-2016</a>)。 设为 yes 与设为 “<code>nearest-bridge</code>“ 等价。 参见上文的 <code>LLDP=</code> 选项 以了解更多有关LLDP的含义。</p>
<h6 id="BindCarrier"><a href="#BindCarrier" class="headerlink" title="BindCarrier"></a>BindCarrier</h6><p>可设为一个网口列表，用于控制当前网口的行为： (1)当列表中的所有网口都处于停用状态(down)的时候，该网口也会被停用。 (2)当列表中的某个网口被启用的时候，该网口也会被启用。</p>
<h6 id="Address"><a href="#Address" class="headerlink" title="Address"></a>Address</h6><p>一个符合 <a target="_blank" rel="noopener" href="http://man7.org/linux/man-pages/man3/inet_pton.3.html">inet_pton(3)</a> 格式的 静态IPv4或IPv6地址及掩码位数 (用 “<code>/</code>“ 字符分隔)。 当 [Address] 小节(见下文)中只含有 <code>Address=</code> 时， 此选项相当于是 [Address] 小节的速记。 可以多次使用此选项以指定多个IP地址。</p>
<p>如果设置的地址是”0.0.0.0”(IPv4) 或 “[::]”(IPv6)， 那么将首先检查所有当前已配置的网络接口以及所有网络配置文件， 然后按照所需地址段的大小， 自动从系统的可用地址池中分配一个新地址段， 并确保不发生任何地址段冲突。 系统默认的IPv4可用地址池如下： 192.168.0.0&#x2F;16, 172.16.0.0&#x2F;12, 10.0.0.0&#x2F;8 ； 系统默认的IPv6可用地址池如下：fc00::&#x2F;7 。 此选项主要用于管理大量动态创建的、 拥有相同网络配置的、需要自动分配地址段的 网络接口。</p>
<h6 id="Gateway"><a href="#Gateway" class="headerlink" title="Gateway"></a>Gateway</h6><p>一个 符合 <a target="_blank" rel="noopener" href="http://man7.org/linux/man-pages/man3/inet_pton.3.html">inet_pton(3)</a> 格式的网关地址。可以多次使用此选项以指定多个网关。 当 [Route] 小节(见下文)中只含有 <code>Gateway=</code> 时， 此选项相当于是 [Route] 小节的速记。</p>
<h6 id="DNS"><a href="#DNS" class="headerlink" title="DNS"></a>DNS</h6><p>一个 符合 <a target="_blank" rel="noopener" href="http://man7.org/linux/man-pages/man3/inet_pton.3.html">inet_pton(3)</a> 格式的DNS服务器地址。可以多次使用此选项以指定多个DNS服务器。 <a target="_blank" rel="noopener" href="http://www.jinbuguo.com/systemd/systemd-resolved.service.html#">systemd-resolved.service(8)</a> 会读取此选项的值。</p>
<h6 id="Domains"><a href="#Domains" class="headerlink" title="Domains"></a>Domains</h6><p>接受一个应该使用此连接的DNS服务器解析的域列表， 列表中的每一项都必须是一个域(可以带有可选的 “<code>~</code>“ 前缀)。 带有 “<code>~</code>“ 前缀的域被称为”路由域”，而不带前缀的域则被称为”搜索域”。 在将单标签主机名(不含”.”的主机名)扩展为FQDN(全限定域名)时，将会首先把”搜索域”用作搜索后缀。 当在此连接上解析一个单标签主机名时，列表中的每一个搜索域都将被依次添加为后缀， 以拼接成一个可用于解析的全限定域名， 直到某一个能够被解析成功为止。</p>
<p>列表中的域(包括搜索域与路由域)都可以用于路由DNS查询请求： 对于那些后缀位于此列表中的主机名(如果存在”搜索域”的话，那么还包括单标签主机名)的DNS查询请求，将会被路由到此连接的DNS服务器上。 对于同时承载多个域的主机来说，如果希望在不同的网络接口上拥有不同的私有DNS区域， 那么可以使用此处的域名路由逻辑。</p>
<p>特殊值 “<code>~.</code>“ (前面的波浪号表示这是一个”路由域”，后面的点表示根域(也就是所有域的后缀))拥有特殊的含义， 它表示将所有未能匹配其他域名路由规则的DNS请求，路由到此连接的DNS服务器上。 利用这个特殊值， 可以设置一组默认的DNS服务器。</p>
<p><a target="_blank" rel="noopener" href="http://www.jinbuguo.com/systemd/systemd-resolved.service.html#">systemd-resolved.service(8)</a> 会读取此选项的值。 “搜索域”对应于 <a target="_blank" rel="noopener" href="http://man7.org/linux/man-pages/man5/resolv.conf.5.html">resolv.conf(5)</a> 中的 <code>domain</code> 与 <code>search</code> 项。 在传统的 glibc API 中 无法找到与此处描述的域名路由逻辑对应的功能。</p>
<h6 id="DNSDefaultRoute"><a href="#DNSDefaultRoute" class="headerlink" title="DNSDefaultRoute"></a>DNSDefaultRoute</h6><p>接受一个布尔值。设为 yes 表示为此连接配置的 DNS 服务器， 将被用于解析不匹配任何其他连接 <code>Domains=</code> 设置的域名。 设为 no 表示为此连接配置的 DNS 服务器，仅用于解析匹配此链接上至少一个 <code>Domains=</code> 的域名(也就是完全不用于解析上述域名)。 若未设置此选项，则默认使用自动模式： 如果此连接没有配置任何”路由域”，那么，为此连接配置的 DNS 服务器， 将用于解析不匹配任何其他连接 <code>Domains=</code> 的域名。</p>
<h6 id="NTP"><a href="#NTP" class="headerlink" title="NTP"></a>NTP</h6><p>一个时间服务器(NTP)地址。可以多次使用此选项以指定多个对时服务器。 <a target="_blank" rel="noopener" href="http://www.jinbuguo.com/systemd/systemd-timesyncd.service.html#">systemd-timesyncd.service(8)</a> 会读取此选项的值。</p>
<h6 id="IPForward"><a href="#IPForward" class="headerlink" title="IPForward"></a>IPForward</h6><p>控制IP转发功能 (将一个网口进入的IP包根据路由表转发到另一个网口)： 默认值 “<code>no</code>“ 表示关闭转发功能； “<code>yes</code>“ 表示开启转发功能； “<code>ipv4</code>“ 表示仅开启IPv4转发； “<code>ipv6</code>“ 表示仅开启IPv6转发； 此选项实际上是设置了 <code>net.ipv4.ip_forward</code>, <code>net.ipv6.conf.all.forwarding</code> 两个 sysctl 项的值(详见 <a target="_blank" rel="noopener" href="https://www.kernel.org/doc/Documentation/networking/ip-sysctl.txt">ip-sysctl.txt</a> 文档)。默认值为 “<code>no</code>“</p>
<p>注意：只有默认值 “<code>no</code>“ 是局部设置，其他三个值都是全局设置。 具体的含义是指： 即使只有一个网络接口开启了IP转发功能(“<code>yes</code>“ 或 “<code>ipv4</code>“ 或 “<code>ipv6</code>“)，也表示在全局开启IP转发功能， 而且即便随后再明确的将此选项设为 “<code>no</code>“ 也无济于事，IP转发功能依然会在全局范围内保持开启。 换句话说，IP转发功能一旦开启便是全局开启，并且不允许随后再关闭，即使针对单个网络接口关闭也不行。</p>
<p>如果只想在两个特定的网络接口之间进行转发，请勿使用此选项， 而是应该使用防火墙规则(iptables)。</p>
<h6 id="IPMasquerade"><a href="#IPMasquerade" class="headerlink" title="IPMasquerade"></a>IPMasquerade</h6><p>若设为 “<code>yes</code>“ 则开启IP地址伪装功能。 它与SNAT(源地址转换技术)的不同之处在于能够自动获取连接的当前ip地址来做转换。 若设为 “<code>yes</code>“ 则隐含了 <code>IPForward=ipv4</code> 设置。 默认值是 “<code>no</code>“</p>
<h6 id="IPv6PrivacyExtensions"><a href="#IPv6PrivacyExtensions" class="headerlink" title="IPv6PrivacyExtensions"></a>IPv6PrivacyExtensions</h6><p>配置IPv6 无状态临时地址(<a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc4941">RFC 4941</a>) 与IPv6隐私扩展。 若设为 “<code>yes</code>“ 则表示开启IPv6隐私扩展并使用临时的私有地址取代公共地址。 若设为 “<code>prefer-public</code>“ 则表示开启IPv6隐私扩展(若失败则关闭IPv6隐私扩展)， 但使用公共地址。 若设为 “<code>kernel</code>“ 则表示不改变内核的现有设置。 默认值 “<code>no</code>“ 表示彻底关闭。</p>
<h6 id="IPv6AcceptRA"><a href="#IPv6AcceptRA" class="headerlink" title="IPv6AcceptRA"></a>IPv6AcceptRA</h6><p>接受一个布尔值。表示是否在此连接上接收IPv6路由通告消息(Router Advertisement)(IPv6的邻居发现协议的一部分)。 设为 yes 表示接收，设为 no 表示不接收(与本地转发的状态无关)。若未设置此选项，则使用内核的默认值： 当本地转发功能被禁用时，此选项的值为”yes”(接收路由通告)；当本地转发功能被开启时，此选项的值为”no”(不接收路由通告)。 如果此选项的值为”yes”(接收路由通告)，那么 DHCPv6 客户端将在两种情况下被启动： (1)传递了相关标志(flag)；(2)在此连接上未发现路由器。</p>
<p>若想进一步详细配置 IPv6 RA 支持，可以参见下面的 “<code>[IPv6AcceptRA]</code>“ 小节。</p>
<p>参见内核的 <a target="_blank" rel="noopener" href="https://www.kernel.org/doc/Documentation/networking/ip-sysctl.txt">ip-sysctl.txt</a> 文档， 并阅读对 “<code>accept_ra</code>“ 属性的解释，不过要注意的是将此选项设为 <code>1</code> 相当于 将 “<code>accept_ra</code>“ 设为 <code>2</code> 。</p>
<h6 id="IPv6DuplicateAddressDetection"><a href="#IPv6DuplicateAddressDetection" class="headerlink" title="IPv6DuplicateAddressDetection"></a>IPv6DuplicateAddressDetection</h6><p>设置要发送的 IPv6 DAD(Duplicate Address Detection) 提示数量。 若未设置此选项，则使用内核的默认值。</p>
<h6 id="IPv6HopLimit"><a href="#IPv6HopLimit" class="headerlink" title="IPv6HopLimit"></a>IPv6HopLimit</h6><p>设置 IPv6 的”Hop Limit”(类似于 IPv4 TTL)值。 每经过一个路由器，该值都会减一， 当减到零时，此包将被丢弃。 若未设置此选项，则使用内核的默认值。</p>
<h6 id="IPv4ProxyARP"><a href="#IPv4ProxyARP" class="headerlink" title="IPv4ProxyARP"></a>IPv4ProxyARP</h6><p>接受一个布尔值， 表示是否为 IPv4 开启”代理ARP”(<a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc1027">RFC1027</a>)支持。 “代理ARP”就是通过一个主机(通常是路由器)来作为指定的设备对其他设备的ARP请求作出应答。 一般用于没有配置默认网关和路由策略的网络中。 若未设置此选项，则使用内核的默认值。</p>
<h6 id="IPv6ProxyNDP"><a href="#IPv6ProxyNDP" class="headerlink" title="IPv6ProxyNDP"></a>IPv6ProxyNDP</h6><p>接受一个布尔值，表示是否支持代理邻居发现协议(Proxy Neighbor Discovery Protocol)。 如果相互通信的两个端点并不直接相连，但是互相又都期望彼此位于同一个直接相连物理连接上时， 可以使用代理邻居发现协议(Proxy Neighbor Discovery Protocol)， 将双方的IPv6地址都映射到”NDP代理”的MAC地址，让”NDP代理”转发两个端点之间的流量， 从而使相互通信的双方看起来就像是在同一个物理连接上直接通信一样。 与 IPv4 的 proxy ARP 技术不同之处在于 IPv6 的NDP代理不是全局开启的， 它仅为”IPv6 neighbor proxy table”中的地址发送邻居宣告消息。 可以使用 <strong>ip -6 neighbour show proxy</strong> 命令显示”IPv6 neighbor proxy table”。 systemd-networkd 将会根据此选项的开关，来控制该接口的 proxy_ndp 开关。 若未设置此选项，则使用内核的默认值。</p>
<h6 id="IPv6ProxyNDPAddress"><a href="#IPv6ProxyNDPAddress" class="headerlink" title="IPv6ProxyNDPAddress"></a>IPv6ProxyNDPAddress</h6><p>用于代理邻居宣告(Neighbor Advertisement)消息的 IPv6 地址(NDP代理)。 可以多次使用此选项以设置多个代理。对于每个已配置的接口， systemd-networkd 将会把此处设置的代理添加到内核的 IPv6 neighbor proxy table 中。 虽然设置此选项相当于隐含的设置了 <code>IPv6ProxyNDP=yes</code> ， 但是如果明确的设置了 <code>IPv6ProxyNDP=no</code> ，那么此选项将被忽略。若未设置此选项，则使用内核的默认值。</p>
<h6 id="IPv6PrefixDelegation"><a href="#IPv6PrefixDelegation" class="headerlink" title="IPv6PrefixDelegation"></a>IPv6PrefixDelegation</h6><p>是否允许在此连接上发送IPv6路由通告消息(Router Advertisement)(IPv6的邻居发现协议的一部分)。 设为 “<code>static</code>“ 表示按照 “<code>[IPv6PrefixDelegation]</code>“ 与任意 “<code>[IPv6Prefix]</code>“ 小节中的定义分配前缀。 设为 “<code>dhcpv6</code>“ 表示使用为另一个连接配置的 DHCPv6 客户端以及在 “<code>[IPv6PrefixDelegation]</code>“ 小节中配置的任意值请求前缀，同时忽略所以静态前缀配置小节。 设为 “<code>yes</code>“ 表示既使用静态配置也使用 DHCPv6 。 设为 “<code>no</code>“ 表示完全关闭 IPv6 前缀委派(Prefix Delegation)。 默认值为 “<code>no</code>“ 。详见 “<code>[IPv6PrefixDelegation]</code>“ 与 “<code>[IPv6Prefix]</code>“ 小节以了解更多配置选项。</p>
<h6 id="IPv6MTUBytes"><a href="#IPv6MTUBytes" class="headerlink" title="IPv6MTUBytes"></a>IPv6MTUBytes</h6><p>设置 IPv6 最大传输单元(MTU)。 必须设为一个大于等于 1280 字节的整数值。若未设置此选项，则使用内核的默认值。</p>
<h6 id="Bridge"><a href="#Bridge" class="headerlink" title="Bridge"></a>Bridge</h6><p>将该连接添加到指定名称的Bridge(网桥)中。参见 <a target="_blank" rel="noopener" href="http://www.jinbuguo.com/systemd/systemd.netdev.html#">systemd.netdev(5)</a> 手册。</p>
<h6 id="Bond"><a href="#Bond" class="headerlink" title="Bond"></a>Bond</h6><p>将该连接添加到指定名称的Bond(多网卡绑定)中。参见 <a target="_blank" rel="noopener" href="http://www.jinbuguo.com/systemd/systemd.netdev.html#">systemd.netdev(5)</a> 手册。</p>
<h6 id="VRF"><a href="#VRF" class="headerlink" title="VRF"></a>VRF</h6><p>将该连接添加到指定名称的VRF(VPN路由与转发表)中。参见 <a target="_blank" rel="noopener" href="http://www.jinbuguo.com/systemd/systemd.netdev.html#">systemd.netdev(5)</a> 手册。</p>
<h6 id="VLAN"><a href="#VLAN" class="headerlink" title="VLAN"></a>VLAN</h6><p>要在此连接上创建的VLAN(虚拟局域网)名称。参见 <a target="_blank" rel="noopener" href="http://www.jinbuguo.com/systemd/systemd.netdev.html#">systemd.netdev(5)</a> 手册。 可以多次使用此选项。</p>
<h6 id="IPVLAN"><a href="#IPVLAN" class="headerlink" title="IPVLAN"></a>IPVLAN</h6><p>要在该连接上创建的 IPVLAN 的名称。详见 <a target="_blank" rel="noopener" href="http://www.jinbuguo.com/systemd/systemd.netdev.html#">systemd.netdev(5)</a> 手册。 可以多次使用此选项。</p>
<h6 id="MACVLAN"><a href="#MACVLAN" class="headerlink" title="MACVLAN"></a>MACVLAN</h6><p>要在此连接上创建的MACVLAN(基于MAC地址划分的虚拟局域网)名称。参见 <a target="_blank" rel="noopener" href="http://www.jinbuguo.com/systemd/systemd.netdev.html#">systemd.netdev(5)</a> 手册。 可以多次使用此选项。</p>
<h6 id="VXLAN"><a href="#VXLAN" class="headerlink" title="VXLAN"></a>VXLAN</h6><p>要在此连接上创建的VXLAN(虚拟可扩展局域网)名称。参见 <a target="_blank" rel="noopener" href="http://www.jinbuguo.com/systemd/systemd.netdev.html#">systemd.netdev(5)</a> 手册。 可以多次使用此选项。</p>
<h6 id="Tunnel"><a href="#Tunnel" class="headerlink" title="Tunnel"></a>Tunnel</h6><p>要在此连接上创建的Tunnel(隧道)名称。参见 <a target="_blank" rel="noopener" href="http://www.jinbuguo.com/systemd/systemd.netdev.html#">systemd.netdev(5)</a> 手册。 可以多次使用此选项。</p>
<h6 id="ActiveSlave"><a href="#ActiveSlave" class="headerlink" title="ActiveSlave"></a>ActiveSlave</h6><p>接受一个布尔值，设为 yes 表示该设备是等待激活的 slave 设备(必须处于 up 状态)。 此选项仅适用于 “<code>active-backup</code>“, “<code>balance-alb</code>“, “<code>balance-tlb</code>“ 模式。默认值为 no 。 此选项在效果上相当于设置 bond 模块的 active_slave 属性。</p>
<h6 id="PrimarySlave"><a href="#PrimarySlave" class="headerlink" title="PrimarySlave"></a>PrimarySlave</h6><p>接受一个布尔值，设为 yes 表示该设备是首选的 slave 设备， 也就是一旦该设备可用，就立即将其激活， 并且仅在该设备确实已经掉线的情况下才会使用其他 slave 设备。 在希望尽可能优先使用某个 slave 的场合(比如某个 slave 的带宽更高)， 可以使用此选项。 此选项仅适用于 “<code>active-backup</code>“, “<code>balance-alb</code>“, “<code>balance-tlb</code>“ 模式。默认值为 no 。此选项在效果上相当于设置 bond 模块的 primary 属性。</p>
<h6 id="ConfigureWithoutCarrier"><a href="#ConfigureWithoutCarrier" class="headerlink" title="ConfigureWithoutCarrier"></a>ConfigureWithoutCarrier</h6><p>接受一个布尔值，设为 yes 表示即使没有实际的载体，也允许 networkd 配置该连接。 默认值为 no 。</p>
<h5 id="4-Address"><a href="#4-Address" class="headerlink" title="4.Address"></a>4.Address</h5><p>可以使用多个 “<code>[Address]</code>“ 小节来配置多个IP地址。 可在 “<code>[Address]</code>“ 小节中使用的选项如下：</p>
<h6 id="Address-1"><a href="#Address-1" class="headerlink" title="Address"></a>Address</h6><p>含义与 “<code>[Network]</code>“ 小节中同名选项相同。 这是一个必须设置的选项。</p>
<h6 id="Peer"><a href="#Peer" class="headerlink" title="Peer"></a>Peer</h6><p>一个用于点对点网络中的IP地址， 格式与 “<code>Address</code>“ 相同。</p>
<h6 id="Broadcast"><a href="#Broadcast" class="headerlink" title="Broadcast"></a>Broadcast</h6><p>一个 符合 <a target="_blank" rel="noopener" href="http://man7.org/linux/man-pages/man3/inet_pton.3.html">inet_pton(3)</a> 格式的广播地址，仅用于IPv4连接。 若未设置，则自动从 “<code>Address</code>“ 中提取。</p>
<h6 id="Label"><a href="#Label" class="headerlink" title="Label"></a>Label</h6><p>一个地址标签</p>
<h6 id="PreferredLifetime"><a href="#PreferredLifetime" class="headerlink" title="PreferredLifetime"></a>PreferredLifetime</h6><p>设置IP地址的默认有效期。 默认值 “<code>forever</code>“&#x2F;“<code>infinity</code>“ 表示”永不过期”，也就是本小节所设置的IP地址永远有效。 设为 “<code>0</code>“ 表示本小节所设置的IP地址”立即过期”， 除非被明确要求，否则不会被使用。 这种IP地址仅用于 某些需要明确使用该地址的特殊应用程序。</p>
<h6 id="Scope"><a href="#Scope" class="headerlink" title="Scope"></a>Scope</h6><p>IP地址的作用域。可设为 0～255 之间的整数或特殊值 “<code>global</code>“(可用于任何地方), “<code>link</code>“(仅用于局域网), “<code>host</code>“(仅限于主机内通信) 之一。 默认值是 “<code>global</code>“ 。</p>
<h6 id="HomeAddress"><a href="#HomeAddress" class="headerlink" title="HomeAddress"></a>HomeAddress</h6><p>接受一个布尔值。设为 yes 表示将该地址视为 <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc6275">RFC 6275</a> 中定义的”home address”。 仅适用于 IPv6 。默认值是 no</p>
<h6 id="DuplicateAddressDetection"><a href="#DuplicateAddressDetection" class="headerlink" title="DuplicateAddressDetection"></a>DuplicateAddressDetection</h6><p>接受一个布尔值。设为 yes 表示在添加该地址时执行 <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc4862">RFC 4862</a> 中描述的重复地址检测动作。 仅适用于 IPv6 。默认值是 no</p>
<h6 id="ManageTemporaryAddress"><a href="#ManageTemporaryAddress" class="headerlink" title="ManageTemporaryAddress"></a>ManageTemporaryAddress</h6><p>接受一个布尔值。设为 yes 表示内核将按照 <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc3041">RFC 3041</a> 隐私扩展规范，管理根据 <code>Address=</code> 的值作为模版而创建的临时地址。 要想让此设置有效，必须使用 sysctl 将 use_tempaddr 属性设为大于零的值。 给定地址的前缀长度必须是 64 。 开启此选项之后，就像激活了无状态自动配置一样，将允许在手动配置的网络上使用隐私扩展。 仅适用于 IPv6 。默认值是 no</p>
<h6 id="PrefixRoute"><a href="#PrefixRoute" class="headerlink" title="PrefixRoute"></a>PrefixRoute</h6><p>接受一个布尔值。 当添加或修改一个 IPv6 地址时，用户空间程序需要一个禁止添加前缀路由的指示。 这与例如 IFA_F_MANAGERTEMPADDR 等标记一起使用时相关，此时用户空间程序会创建根据 autoconf 生成的地址， 但是取决于不同的环节，有可能不应该为此前缀添加路由。默认值是 no</p>
<h6 id="AutoJoin"><a href="#AutoJoin" class="headerlink" title="AutoJoin"></a>AutoJoin</h6><p>接受一个布尔值。因为交换机不会复制不为多播地址报告IGMP的端口上的多播包， 所以如果有一个能够感知IGMP的以太网交换机， 那么将无法通过 <strong>ip maddr</strong> 命令在以太网层次上加入到多播组中去。 通过 <strong>ip link add vxlan</strong> 命令创建的 vxlan 设备或者通过 systemd-networkd 创建的 vxlan 虚拟网络设备， 都开启了必要的选项以允许它们加入到多播组中去。 通过使用 “<code>autojoin</code>“ 选项扩展 <strong>ip maddr</strong> 命令， 可以让 openvswitch (OVS) vxlan 获得类似的功能， 同时仍然保留其他需要接受多播流量的隧道机制。 默认值是 “<code>no</code>“</p>
<h5 id="5-Neighbor"><a href="#5-Neighbor" class="headerlink" title="5.Neighbor"></a>5.Neighbor</h5><p>“<code>[Neighbor]</code>“ 小节 用于在邻居表(IPv6)或ARP表(IPv4)中， 为给定的MAC地址添加一个永久静态项。 可以使用多个 “<code>[Neighbor]</code>“ 小节来配置多个静态邻居。 可以在 “<code>[Neighbor]</code>“ 小节中使用的选项如下：</p>
<h6 id="Address-2"><a href="#Address-2" class="headerlink" title="Address"></a>Address</h6><p>邻居的IP地址</p>
<h6 id="MACAddress-2"><a href="#MACAddress-2" class="headerlink" title="MACAddress"></a>MACAddress</h6><p>邻居的MAC地址</p>
<h5 id="6-IPv6AddressLabel"><a href="#6-IPv6AddressLabel" class="headerlink" title="6.IPv6AddressLabel"></a>6.IPv6AddressLabel</h5><p>IPv6地址标签用于地址选择(参见 <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc3484">RFC 3484</a>)。 内核仅存储标签自身，而标签的优先级则由用户空间程序管理。 可以使用多个 “<code>[IPv6AddressLabel]</code>“ 小节来配置多个IPv6地址标签。 可在 “<code>[IPv6AddressLabel]</code>“ 小节中使用的选项如下：</p>
<h6 id="Label-1"><a href="#Label-1" class="headerlink" title="Label"></a>Label</h6><p>用于前缀(一个无符号整数)的标签，必须设为 0 到 4294967294 之间的一个整数。 0xffffffff 是预留值，禁止使用。这是一个必须设置的选项。</p>
<h6 id="Prefix"><a href="#Prefix" class="headerlink" title="Prefix"></a>Prefix</h6><p>IPv6前缀是指一个带有前缀长度的地址(以 “<code>/</code>“ 字符分隔)。 这是一个必须设置的选项。</p>
<h5 id="7-RoutingPolicyRule"><a href="#7-RoutingPolicyRule" class="headerlink" title="7.RoutingPolicyRule"></a>7.RoutingPolicyRule</h5><p>可以使用多个 “<code>[RoutingPolicyRule]</code>“ 小节来配置多个路由策略。 可在 “<code>[RoutingPolicyRule]</code>“ 小节中使用的选项如下：</p>
<h6 id="TypeOfService"><a href="#TypeOfService" class="headerlink" title="TypeOfService"></a>TypeOfService</h6><p>指定要匹配的服务类型。可设为一个 0～255 之间的整数。</p>
<h6 id="From"><a href="#From" class="headerlink" title="From"></a>From</h6><p>指定要匹配的源地址前缀。可以加上”&#x2F;前缀长度”后缀。</p>
<h6 id="To"><a href="#To" class="headerlink" title="To"></a>To</h6><p>指定要匹配的目的地址前缀。可以加上”&#x2F;前缀长度”后缀。</p>
<h6 id="FirewallMark"><a href="#FirewallMark" class="headerlink" title="FirewallMark"></a>FirewallMark</h6><p>指定要匹配的 iptables 防火墙标签值(一个介于 1～4294967295 之间的整数)</p>
<h6 id="Table"><a href="#Table" class="headerlink" title="Table"></a>Table</h6><p>指定在规则选择器匹配成功时， 要查找的路由表ID(一个介于 1～4294967295 之间的整数)。</p>
<h6 id="Priority"><a href="#Priority" class="headerlink" title="Priority"></a>Priority</h6><p>指定该规则的优先级，必须设为一个无符号整数。 数值越小优先级越高，也就是多条规则按照各自优先级数值从小到大的顺序处理。</p>
<h6 id="IncomingInterface"><a href="#IncomingInterface" class="headerlink" title="IncomingInterface"></a>IncomingInterface</h6><p>指定要匹配的流入设备。如果设为回环接口，那么表示该规则仅匹配本机产生的数据包。</p>
<h6 id="OutgoingInterface"><a href="#OutgoingInterface" class="headerlink" title="OutgoingInterface"></a>OutgoingInterface</h6><p>指定要匹配的流出设备。流出接口仅用于源自绑定到某个设备的本地套接字的数据包。</p>
<h6 id="SourcePort"><a href="#SourcePort" class="headerlink" title="SourcePort"></a>SourcePort</h6><p>指定要在转发信息库(FIB)规则中匹配的源IP端口或源IP端口范围。 可以通过”低端口-高端口”格式(使用连字符)来指定端口范围。默认未设置。</p>
<h6 id="DestinationPort"><a href="#DestinationPort" class="headerlink" title="DestinationPort"></a>DestinationPort</h6><p>指定要在转发信息库(FIB)规则中匹配的目标IP端口或目标IP端口范围。 可以通过”低端口-高端口”格式(使用连字符)来指定端口范围。默认未设置。</p>
<h6 id="IPProtocol"><a href="#IPProtocol" class="headerlink" title="IPProtocol"></a>IPProtocol</h6><p>指定要在转发信息库(FIB)规则中匹配的IP协议。可设为例如 “<code>tcp</code>“, “<code>udp</code>“, “<code>sctp</code>“ 这样的协议名称，或者例如 “<code>6</code>“(“<code>tcp</code>“), “<code>17</code>“(“<code>udp</code>“) 这样的协议号。 默认未设置。</p>
<h6 id="InvertRule"><a href="#InvertRule" class="headerlink" title="InvertRule"></a>InvertRule</h6><p>一个布尔值。表示是否反转规则。默认为 no 。</p>
<h5 id="8-Route"><a href="#8-Route" class="headerlink" title="8.Route"></a>8.Route</h5><p>可以使用多个 “<code>[Route]</code>“ 小节来配置多个路由。 可在 “<code>[Route]</code>“ 小节中使用的选项如下：</p>
<h6 id="Gateway-1"><a href="#Gateway-1" class="headerlink" title="Gateway"></a>Gateway</h6><p>含义与 “<code>[Network]</code>“ 中的同名选项相同。</p>
<h6 id="GatewayOnlink"><a href="#GatewayOnlink" class="headerlink" title="GatewayOnlink"></a>GatewayOnlink</h6><p>接受一个布尔值。默认值为 “<code>no</code>“ 。 设为 yes 表示要求内核不必检查本小节设置的网关是否直接可达， 也就是内核不必检查本小节所设置的网关是否确实连接到了本地网络上。 这样，在向内核的路由表插入路由记录时，可以阻止内核抱怨”路由不可达”的错误。</p>
<h6 id="Destination"><a href="#Destination" class="headerlink" title="Destination"></a>Destination</h6><p>该路由的目的地址前缀，可以带有”&#x2F;前缀长度”后缀， 如果省略了此后缀， 则视为一个全长度的主机路由。</p>
<h6 id="Source"><a href="#Source" class="headerlink" title="Source"></a>Source</h6><p>该路由的源地址前缀，可以带有”&#x2F;前缀长度”后缀， 如果省略了此后缀， 则视为一个全长度的主机路由。</p>
<h6 id="Metric"><a href="#Metric" class="headerlink" title="Metric"></a>Metric</h6><p>该路由的跃点数(一个正整数)</p>
<h6 id="IPv6Preference"><a href="#IPv6Preference" class="headerlink" title="IPv6Preference"></a>IPv6Preference</h6><p>为路由发现消息(Router Discovery messages)设置路由优先级(参见 <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc4191">RFC4191</a>)。 可设为如下值： “<code>low</code>“ 表示最低优先级、 “<code>medium</code>“ 表示默认优先级、 “<code>high</code>“ 表示最高优先级。</p>
<h6 id="Scope-1"><a href="#Scope-1" class="headerlink" title="Scope"></a>Scope</h6><p>该路由的适用范围： “<code>global</code>“, “<code>link</code>“, “<code>host</code>“ 。 默认值为 “<code>global</code>“</p>
<h6 id="PreferredSource"><a href="#PreferredSource" class="headerlink" title="PreferredSource"></a>PreferredSource</h6><p>该路由的首选源地址， 必须符合 <a target="_blank" rel="noopener" href="http://man7.org/linux/man-pages/man3/inet_pton.3.html">inet_pton(3)</a> 格式。</p>
<h6 id="Table-num"><a href="#Table-num" class="headerlink" title="Table=_num_"></a><code>Table=_</code>num<code>_</code></h6><p>该路由表的标识符(可设为 1~4294967295 之间的整数， 0 表示不设置标识符)。 可以通过 <strong>ip route show table <em><code>num</code></em></strong> 命令查看此路由表的内容。</p>
<h6 id="Protocol"><a href="#Protocol" class="headerlink" title="Protocol"></a>Protocol</h6><p>设置路由的协议标识符。可设为 0 到 255 之间的整数，或者特殊值 “<code>kernel</code>“, “<code>boot</code>“, “<code>static</code>“ 之一。默认值为 “<code>static</code>“</p>
<h6 id="Type"><a href="#Type" class="headerlink" title="Type"></a>Type</h6><p>设置路由的类型。可设为下列值之一： “<code>unicast</code>“ 表示描述前往目的地址的真实路径(单播路由)、 “<code>blackhole</code>“ 表示直接悄无声息的丢弃数据包(黑洞路由)、 “<code>unreachable</code>“ 表示直接丢弃数据包并返回一个”主机不可达”ICMP消息、 “<code>prohibit</code>“ 表示直接丢弃数据包并返回一个”通信被禁止”ICMP消息。 “<code>throw</code>“ 表示在当前路由表中的路由查找将失败，路由选择过程将返回到路由策略数据库(RPDB)。 默认值是 “<code>unicast</code>“ 。</p>
<h6 id="InitialCongestionWindow"><a href="#InitialCongestionWindow" class="headerlink" title="InitialCongestionWindow"></a>InitialCongestionWindow</h6><p>设置启动TCP连接时使用的初始TCP拥塞窗口大小。在TCP会话启动期间， 当客户端请求资源时，服务器的初始拥塞窗口大小决定了首次数据传输时一次性向客户端发送多少字节的数据。 取值范围是 1 到 4294967295(2^32 - 1) 字节(可以使用以1024为基准的 K, M, G 后缀)。 若未设置此选项，则使用内核的默认值。</p>
<h6 id="InitialAdvertisedReceiveWindow"><a href="#InitialAdvertisedReceiveWindow" class="headerlink" title="InitialAdvertisedReceiveWindow"></a>InitialAdvertisedReceiveWindow</h6><p>设置TCP初始接收窗口大小，也就是首次传输时可以一次性接受多少字节的数据。 在等待接收端确认和更新窗口之前，发送端每次最多只能发送该这么多数据。 取值范围是 1 到 4294967295(2^32 - 1) 字节(可以使用以1024为基准的 K, M, G 后缀)。 若未设置此选项，则使用内核的默认值。</p>
<h6 id="QuickAck"><a href="#QuickAck" class="headerlink" title="QuickAck"></a>QuickAck</h6><p>接受一个布尔值。设为 yes 表示为路由启用 TCP “quick ack”模式。若未设置此选项，则使用内核的默认值。</p>
<h6 id="MTUBytes-1"><a href="#MTUBytes-1" class="headerlink" title="MTUBytes"></a>MTUBytes</h6><p>设置该路由的最大传输单元。 单位是字节(可以使用 以1024为基准的 K, M, G 后缀)。</p>
<p>注意，如果在此连接上启用了 IPv6 ，那么任何小于 1280 (IPv6 的最小 MTU 值) 的值都会被自动增加到 1280 。</p>
<h5 id="9-DHCP"><a href="#9-DHCP" class="headerlink" title="9.DHCP"></a>9.DHCP</h5><p>“<code>[DHCP]</code>“ 小节用于配置 DHCPv4&#x2F;DHCP6 客户端。 仅在 [Network] 小节中的 <code>DHCP=</code> 选项已开启的情况下有意义。</p>
<h6 id="UseDNS"><a href="#UseDNS" class="headerlink" title="UseDNS"></a>UseDNS</h6><p>默认值 yes 表示 从DHCP服务器接收DNS服务器的设置， 同时无视任何本地的静态DNS配置。</p>
<p>这相当于 <a target="_blank" rel="noopener" href="http://man7.org/linux/man-pages/man5/resolv.conf.5.html">resolv.conf(5)</a> 中 <code>nameserver</code> 的作用。</p>
<h6 id="UseNTP"><a href="#UseNTP" class="headerlink" title="UseNTP"></a>UseNTP</h6><p>默认值 yes 表示 从DHCP服务器接收NTP服务器的设置(被 systemd-timesyncd 使用)， 同时无视任何本地的静态NTP配置。</p>
<h6 id="UseMTU"><a href="#UseMTU" class="headerlink" title="UseMTU"></a>UseMTU</h6><p>若设为 yes 则表示 从DHCP服务器接收MTU(最大传输单元)的设置。 如果已经设置了 <code>MTUBytes=</code> 选项，那么此选项将被忽略。 默认值是 no 。</p>
<h6 id="Anonymize"><a href="#Anonymize" class="headerlink" title="Anonymize"></a>Anonymize</h6><p>接受一个布尔值。设为 yes 表示按照 <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc7844">RFC 7844</a> 规范向 DHCP 服务器发送选项， 也就是不再发送例如主机名之类暴露用户身份的信息，以实现匿名的网络访问。 默认值是 no 。</p>
<p>此选项应该仅在 <code>MACAddressPolicy=random</code> 的情况下才可以设为 yes 。 参见 <a target="_blank" rel="noopener" href="http://www.jinbuguo.com/systemd/systemd.link.html#">systemd.link(5)</a> 手册。</p>
<p>注意，当此选项被设为 yes 之后， 下列选项将被忽略： <code>SendHostname=</code>, <code>ClientIdentifier=</code>, <code>UseRoutes=</code>, <code>SendHostname=</code>, <code>UseMTU=</code>, <code>VendorClassIdentifier=</code>, &#96;UseTimezone</p>
<h6 id="SendHostname"><a href="#SendHostname" class="headerlink" title="SendHostname"></a>SendHostname</h6><p>默认值 yes 表示将本机的主机名(hostname)发送给DHCP服务器。 注意，主机名只能由7位ASCII小写字母、数字、连字符(-)组成，并且必须格式化为有效的DNS域名。 否则，即使将此选项设为 yes ， 也不会发送主机名。</p>
<h6 id="UseHostname"><a href="#UseHostname" class="headerlink" title="UseHostname"></a>UseHostname</h6><p>默认值 yes 表示 将从DHCP服务器接收到的主机名(hostname)设置为系统的临时主机名。</p>
<h6 id="Hostname"><a href="#Hostname" class="headerlink" title="Hostname"></a>Hostname</h6><p>将此选项的值(而不是真实的主机名)作为主机名发送给 DHCP 服务器。 注意，主机名只能由7位ASCII小写字母、数字、连字符(-)组成， 并且必须格式化为有效的DNS域名。</p>
<h6 id="UseDomains"><a href="#UseDomains" class="headerlink" title="UseDomains"></a>UseDomains</h6><p>接受一个布尔值或特殊值 “<code>route</code>“ 。 yes 表示将从DHCP服务器接收到的域用于此连接的DNS搜索域。 在效果上与 <code>Domains=</code> 中不带 “<code>~</code>“ 前缀的值类似。 “<code>route</code>“ 表示仅将从DHCP服务器接收到的域用于路由DNS查询(而不用于搜索)， 在效果上与 <code>Domains=</code> 中带有 “<code>~</code>“ 前缀的值类似。 默认值为 no 。</p>
<p>建议仅在可信任网络环境中才能将此选项设为 yes 。 因为它会影响到所有主机名的解析，特别是单标签主机名(不含”.”的主机名)的解析。 一般来说，仅设置”路由域”而不设置”搜索域”是安全的， 因为这样做不会影响到单标签主机名(不含”.”的主机名)的解析。</p>
<p>当设为 yes 时，此选项相当于 <a target="_blank" rel="noopener" href="http://man7.org/linux/man-pages/man5/resolv.conf.5.html">resolv.conf(5)</a> 中 <code>domain</code> 的作用。</p>
<h6 id="UseRoutes"><a href="#UseRoutes" class="headerlink" title="UseRoutes"></a>UseRoutes</h6><p>默认值 yes 表示从DHCP服务器请求静态路由，并将DHCP服务器返回的结果添加到本机的路由表中， 同时将跃点数设为 1024 ，此外，还会根据路由目的地址以及网关的不同，将 scope 值设为 “global”, “link”, “host” 之一。 如果目的地址就在本机(例如 127.x.x.x 或者本地连接自身的地址)，那么 scope 值将被设为 “host” ， 否则如果网关不存在(也就是直接路由)，那么 scope 值将被设为 “link” 。 对于其他情况， scope 值将被设为默认的 “global” 。</p>
<h6 id="UseTimezone"><a href="#UseTimezone" class="headerlink" title="UseTimezone"></a>UseTimezone</h6><p>若设为 yes 则表示 将从DHCP服务器接收到的时区用作本机的时区。 默认值是 “<code>no</code>“</p>
<h6 id="CriticalConnection"><a href="#CriticalConnection" class="headerlink" title="CriticalConnection"></a>CriticalConnection</h6><p>若设为 yes 则表示 即使所获得的IP地址租约已经过期，也不归还，依然继续使用。 这种做法是与DHCP协议相违背的， 但在某些场合却是最佳的选择(例如根文件系统依赖于此连接)。 默认值为 no</p>
<h6 id="ClientIdentifier"><a href="#ClientIdentifier" class="headerlink" title="ClientIdentifier"></a>ClientIdentifier</h6><p>使用什么样的 DHCPv4 客户端标识符： “<code>mac</code>“ 表示连接的MAC地址； “<code>duid</code>“ 表示一个符合RFC4361规范的客户端ID(也就是 IAID 与 DUID 的组合)； “<code>duid-only</code>“ 表示仅使用 DUID (可能与 RFC 规范不兼容，但某些场合需要这样做)。 默认值是 “<code>duid</code>“</p>
<h6 id="VendorClassIdentifier"><a href="#VendorClassIdentifier" class="headerlink" title="VendorClassIdentifier"></a>VendorClassIdentifier</h6><p>标识厂商类型与配置的厂商类标识符(DHCP Option 60)， 这是一个DHCP可选项。</p>
<h6 id="UserClass"><a href="#UserClass" class="headerlink" title="UserClass"></a>UserClass</h6><p>用于 DHCPv4 客户端标识用户或应用的类型(DHCP “User Class” 选项)。 此选项中包含的字符串表明此客户端是哪些用户类的成员。 每个类都有一个标识字符串，供DHCP服务对客户端进行分类。 此选项接受一个空白分隔的字符串列表。</p>
<h6 id="DUIDType"><a href="#DUIDType" class="headerlink" title="DUIDType"></a>DUIDType</h6><p>为此连接设置一个专用的 <code>DUIDType</code> 以覆盖全局默认值。参见 <a target="_blank" rel="noopener" href="http://www.jinbuguo.com/systemd/networkd.conf.html#">networkd.conf(5)</a> 以了解可用值。</p>
<h6 id="DUIDRawData"><a href="#DUIDRawData" class="headerlink" title="DUIDRawData"></a>DUIDRawData</h6><p>为此连接设置一个专用的 <code>DUIDRawData</code> 以覆盖全局默认值。参见 <a target="_blank" rel="noopener" href="http://www.jinbuguo.com/systemd/networkd.conf.html#">networkd.conf(5)</a> 以了解可用值。</p>
<h6 id="IAID"><a href="#IAID" class="headerlink" title="IAID"></a>IAID</h6><p>为此连接设置一个 DHCP IAID(Identity Association Identifier) ，一个 32-bit 无符号整数。</p>
<h6 id="RequestBroadcast"><a href="#RequestBroadcast" class="headerlink" title="RequestBroadcast"></a>RequestBroadcast</h6><p>要求DHCP服务器在完成配置IP地址之前使用广播消息。 对于不能接收原始包的网卡， 或者 在配置IP地址之前不能接收任何包的网卡来说，必须开启此选项。 另一方面， 对于广播包被屏蔽的网络来说，则必须关闭此选项。</p>
<h6 id="RouteMetric"><a href="#RouteMetric" class="headerlink" title="RouteMetric"></a>RouteMetric</h6><p>指定由DHCP分配的路由的 跃点数(一个正整数)。</p>
<h6 id="RouteTable-num"><a href="#RouteTable-num" class="headerlink" title="RouteTable=_num_"></a><code>RouteTable=_</code>num<code>_</code></h6><p>DHCP路由表标识符(一个 1 到 4294967295 之间的整数， 0 表示未设置)。 可以使用 <strong>ip route show table <em><code>num</code></em></strong> 查看路由表内容。</p>
<p>除非已经明确为此选项设置了一个正整数， 否则当与 <code>VRF=</code> 一起使用时，将会使用VRF的路由表。</p>
<h6 id="ListenPort"><a href="#ListenPort" class="headerlink" title="ListenPort"></a>ListenPort</h6><p>设置DHCP客户端的监听端口(客户端默认在UDP的68端口监听)。</p>
<h6 id="RapidCommit"><a href="#RapidCommit" class="headerlink" title="RapidCommit"></a>RapidCommit</h6><p>接受一个布尔值。 DHCPv6 客户端可以通过一种被称为”rapid commit”的快速两消息交换方式(solicit, reply)从 DHCPv6 服务器获得配置参数。 如果 DHCPv6 客户端与服务器都支持”rapid commit”选项， 那么将会使用快速两消息交换方式(solicit, reply)取代默认的四消息交换方式(solicit, advertise, request, reply)。 两消息交换方式提高了客户端配置速度，在网络负债较重的环境中很有意义。 详见 <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc3315#section-17.2.1">RFC 3315</a> 文档。 默认值为 yes 。</p>
<h6 id="ForceDHCPv6PDOtherInformation"><a href="#ForceDHCPv6PDOtherInformation" class="headerlink" title="ForceDHCPv6PDOtherInformation"></a>ForceDHCPv6PDOtherInformation</h6><p>接受一个布尔值。 设为 yes 表示即使在路由通告(Router Advertisement)消息中设置了’Other information’位，也强制使用 DHCPv6 有状态模式。 默认情况下，当在路由通告(Router Advertisement)消息中仅设置了’Other information’位时， DHCPv6 将以无状态的两消息交换方式请求网络信息。但是在 <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc7084">RFC 7084</a>(要求 WPD-4)规范中， 针对客户边缘(Customer Edge)路由器，此种默认行为发生了改变，使得即使在路由通告(Router Advertisement)消息中仅设置了’Other information’位， 也将请求有状态的 DHCPv6 前缀委派(Prefix Delegation)。 此选项就用于开启这种 CE(Customer Edge) 行为，否则无法自动区分’Other information’位的含义。 此选项的默认值是 no 。 当该网络设备用作 CE(Customer Edge) 路由器时(不需要委派前缀)，应该将此选项设为 yes 。</p>
<h5 id="10-IPv6AcceptRA"><a href="#10-IPv6AcceptRA" class="headerlink" title="10.IPv6AcceptRA"></a>10.IPv6AcceptRA</h5><p>“<code>[IPv6AcceptRA]</code>“ 用于配置IPv6路由通告(Router Advertisement)客户端。 仅在 [Network] 小节中的 <code>IPv6AcceptRA=</code> 选项已开启的情况下有意义。</p>
<h6 id="UseDNS-1"><a href="#UseDNS-1" class="headerlink" title="UseDNS"></a>UseDNS</h6><p>默认值 yes 表示从IPv6路由通告消息中接收DNS服务器的设置， 同时无视任何本地的静态DNS配置。</p>
<p>这相当于 <a target="_blank" rel="noopener" href="http://man7.org/linux/man-pages/man5/resolv.conf.5.html">resolv.conf(5)</a> 中 <code>nameserver</code> 的作用。</p>
<h6 id="UseDomains-1"><a href="#UseDomains-1" class="headerlink" title="UseDomains"></a>UseDomains</h6><p>接受一个布尔值。或特殊值 “<code>route</code>“ 。 yes 表示将从IPv6路由通告消息中接收到的域用于此连接的DNS搜索域。 在效果上与 <code>Domains=</code> 中不带 “<code>~</code>“ 前缀的值类似。 “<code>route</code>“ 表示仅将从IPv6路由通告消息中接收到的域用于路由DNS查询(而不用于搜索)， 在效果上与 <code>Domains=</code> 中带有 “<code>~</code>“ 前缀的值类似。 默认值为 no</p>
<p>建议仅在可信任网络环境中才能将此选项设为 yes 。 因为它会影响到所有主机名的解析，特别是单标签主机名(不含”.”的主机名)的解析。 一般来说，仅设置”路由域”而不设置”搜索域”是安全的， 因为这样做不会影响到单标签主机名(不含”.”的主机名)的解析。</p>
<p>当设为 yes 时，此选项相当于 <a target="_blank" rel="noopener" href="http://man7.org/linux/man-pages/man5/resolv.conf.5.html">resolv.conf(5)</a> 中 <code>nameserver</code> 的作用。</p>
<h6 id="RouteTable-num-1"><a href="#RouteTable-num-1" class="headerlink" title="RouteTable&#x3D;num"></a>RouteTable&#x3D;<em><code>num</code></em></h6><p>在路由通告中接收到的路由表编号(一个 1 到 4294967295 之间的整数， 0 表示未设置)。 可以使用 <strong>ip route show table <em><code>num</code></em></strong> 命令显示表内容。</p>
<h5 id="11-DHCPServer"><a href="#11-DHCPServer" class="headerlink" title="11.DHCPServer"></a>11.DHCPServer</h5><p>“<code>[DHCPServer]</code>“ 小节用于配置 DHCPv4 服务端。 仅在 [Network] 小节中的 <code>DHCPServer=</code> 选项已开启的情况下有意义。</p>
<h6 id="PoolOffset-PoolSize"><a href="#PoolOffset-PoolSize" class="headerlink" title="PoolOffset&#x3D;, PoolSize"></a>PoolOffset&#x3D;<code>, </code>PoolSize</h6><p>配置可用于动态分配的IP地址池。 地址池必须与DHCP服务器的IP地址位于同一子网内， 并且不得包含子网地址与广播地址。 <code>PoolOffset=</code> 用于设置地址池的起点，用相对于子网起点的偏移量表示。 若设为”0”则表示使用默认值。 <code>PoolSize=</code> 用于设置地址池的长度(也就是包含的IP地址数量)。 若设为”0”则表示使用默认值。 默认情况下，地址池的起点位于子网地址之后的第一个地址， 终点位于广播地址前面的那个地址，也就是包含了全部的可分配地址。 如果地址池中正好包含了DHCP服务器自身的地址(默认情况就是这样)也没关系， 这个地址不会被分配给DHCP客户端。</p>
<h6 id="DefaultLeaseTimeSec-MaxLeaseTimeSec"><a href="#DefaultLeaseTimeSec-MaxLeaseTimeSec" class="headerlink" title="DefaultLeaseTimeSec&#x3D;, MaxLeaseTimeSec"></a>DefaultLeaseTimeSec&#x3D;<code>, </code>MaxLeaseTimeSec</h6><p>设置传递给DHCP客户端的 默认租期(默认”1h”)与最大租期(默认”12h”)， 可以使用 “min”, “h”, “days”, “weeks”, “months” 后缀。 默认租期用于客户端未指定租约时长的情况。 如果客户端指定的租约时长超过了此处设置的最大值， 那么将自动限制为此处设置的最大值。 如果租约经常变化， 那么应该设置较小的值； 反之， 为了降低DHCP所占用的网络流量， 应该设置较大的值。</p>
<h6 id="EmitDNS-DNS"><a href="#EmitDNS-DNS" class="headerlink" title="EmitDNS&#x3D;, DNS"></a>EmitDNS&#x3D;<code>, </code>DNS</h6><p>接受一个布尔值。 设置是否要给DHCP客户端传递DNS服务器信息。 默认值 “<code>yes</code>“ 表示要传递。 而 <code>DNS=</code> 则用于设置一个 要传递的DNS服务器列表(以IPv4地址表示)。 如果 <code>EmitDNS=yes</code> 但同时并未设置 <code>DNS=</code> 的值， 那么将自动使用从”上级连接”中获得的DNS服务器列表。 所谓”上级连接”是指 系统中优先级最高的默认路由。 注意： (1)不会从本机的 <code>/etc/resolv.conf</code> 中提取DNS服务器。 (2)并不通知DHCP客户端”上级连接”的DNS变化。 为了确保客户端能够及时知晓”上级连接”的DNS变化， 应该减小 <code>MaxLeaseTimeSec=</code> 的值。</p>
<h6 id="EmitNTP-NTP"><a href="#EmitNTP-NTP" class="headerlink" title="EmitNTP&#x3D;, NTP"></a>EmitNTP&#x3D;<code>, </code>NTP</h6><p>与 <code>EmitDNS=</code> 和 <code>DNS=</code> 完全相同， 不同之处 仅在于 这两个选项针对的是 NTP时间服务器。</p>
<h6 id="EmitRouter"><a href="#EmitRouter" class="headerlink" title="EmitRouter"></a>EmitRouter</h6><p>与 <code>EmitDNS=</code> 完全相同， 不同之处仅在于 这两个选项针对的是 路由器。</p>
<h6 id="EmitTimezone-Timezone"><a href="#EmitTimezone-Timezone" class="headerlink" title="EmitTimezone,Timezone"></a>EmitTimezone,Timezone</h6><p>接受一个布尔值。 设置是否要给DHCP客户端传递时区信息。默认值 “<code>yes</code>“ 表示要传递。 而 <code>Timezone=</code> 则用于设置一个要传递的时区字符串， 例如 “<code>Asia/Shanghai</code>“(中华民国中原时区) 或 “<code>UTC</code>“(世界统一时间) 或 “<code>PRC</code>“(中华人民共和国)。 若未明确设置 <code>Timezone=</code> 的值， 那么将使用本机的时区，也就是 <code>/etc/localtime</code> 软连接。</p>
<h5 id="12-IPv6PrefixDelegation"><a href="#12-IPv6PrefixDelegation" class="headerlink" title="12.IPv6PrefixDelegation"></a>12.IPv6PrefixDelegation</h5><p>“<code>[IPv6PrefixDelegation]</code>“ 小节用于配置如何发送IPv6路由通告消息(IPv6 Router Advertisement)以及是否用作路由器角色， 仅在 [Network] 小节中的 <code>IPv6PrefixDelegation=</code> 选项已开启的情况下有意义。 IPv6 网络前缀定义在一个或多个 “<code>[IPv6Prefix]</code>“ 小节中。</p>
<h6 id="Managed-OtherInformation"><a href="#Managed-OtherInformation" class="headerlink" title="Managed,OtherInformation"></a>Managed,OtherInformation</h6><p>此二选项 都只接受一个布尔值。 <code>Managed=yes</code> 表示通过 DHCPv6 服务器来获取 IPv6 地址。 <code>OtherInformation=yes</code> 表示通过 DHCPv6 服务器来获取其他信息。 此二选项的默认值都是 “<code>no</code>“ ，表示完全不使用 DHCPv6 服务器。</p>
<h6 id="RouterLifetimeSec"><a href="#RouterLifetimeSec" class="headerlink" title="RouterLifetimeSec"></a>RouterLifetimeSec</h6><p>设置此连接作为 IPv6 路由器的时长(单位是秒)。 如果设置了此选项，那么将会在路由通告消息中将该网络连接宣布为一个 IPv6 路由器。 若未设置此选项，则表示本机不是一个路由器。</p>
<h6 id="RouterPreference"><a href="#RouterPreference" class="headerlink" title="RouterPreference"></a>RouterPreference</h6><p>设置 IPv6 路由的优先权，此选项仅在 <code>RouterLifetimeSec=</code> 非零的时候有意义。 可设为 “<code>high</code>“, “<code>medium</code>“(默认值), “<code>low</code>“ 之一。 详见 <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc4191">RFC 4191</a> 文档。</p>
<h6 id="EmitDNS-DNS-1"><a href="#EmitDNS-DNS-1" class="headerlink" title="EmitDNS,DNS"></a>EmitDNS,DNS</h6><p>DNS&#x3D;<code>用于设置当</code>EmitDNS&#x3D;yes<code>时， 通过路由通告(Router Advertisement)消息分发的递归DNS服务器的 IPv6 地址列表。 如果</code>DNS&#x3D;<code> 的值为空， 那么 DNS 服务器将从 &quot;</code>[Network]<code>&quot; 小节读取。如果 &quot;</code>[Network]<code>&quot; 小节也不包含任何 DNS 服务器， 那么，将使用来自于上行链路中优先级最高的默认路由的 DNS 服务器。 如果 </code>EmitDNS&#x3D;no<code>， 那么将不会在路由通告(Router Advertisement)消息中发送DNS服务器信息。</code>EmitDNS&#x3D;&#96; 的默认值是 yes 。</p>
<h6 id="EmitDomains-Domains"><a href="#EmitDomains-Domains" class="headerlink" title="EmitDomains,Domains"></a>EmitDomains,Domains</h6><p>Domains&#x3D;<code>用于设置当</code>EmitDomains&#x3D;yes<code>时， 通过路由通告(Router Advertisement)消息分发的DNS搜索域列表。 如果</code>Domains&#x3D;<code> 的值为空，那么DNS搜索域将从 &quot;</code>[Network]<code>&quot; 小节读取。如果 &quot;</code>[Network]<code>&quot; 小节也不包含任何DNS搜索域， 那么，将使用来自于上行链路中优先级最高的默认路由的DNS搜索域。 如果 </code>EmitDomains&#x3D;no<code>， 那么将不会在路由通告(Router Advertisement)消息中发送DNS搜索域信息。</code>EmitDomains&#x3D;&#96; 的默认值是 yes 。</p>
<h6 id="DNSLifetimeSec"><a href="#DNSLifetimeSec" class="headerlink" title="DNSLifetimeSec"></a>DNSLifetimeSec</h6><p>设置 <code>DNS=</code> 与 <code>Domains=</code> 两个选项中设置的列表的有效期(单位是秒)。</p>
<h5 id="13-IPv6Prefix"><a href="#13-IPv6Prefix" class="headerlink" title="13.IPv6Prefix"></a>13.IPv6Prefix</h5><p>可以设置多个 “<code>[IPv6Prefix]</code>“ 小节， 每个小节都包含一个通过路由通告声明的 IPv6 前缀。详见 <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc4861">RFC 4861</a> 文档。</p>
<p>AddressAutoconfiguration&#x3D;<code>, </code>OnLink<br>此二选项都只接受一个布尔值。 <code>AddressAutoconfiguration=yes</code> 表示允许自动配置带有此前缀的 IPv6 地址。 <code>OnLink=yes</code> 表示此前缀可用于在线(OnLink)检测。 此二选项的默认值都是 “<code>yes</code>“ 以简化配置难度。</p>
<p>Prefix<br>设置用于分发的 IPv6 前缀。 值是一个形如 “<code>IPv6地址/前缀长度</code>“ 的字符串。 因为每个 IPv6 前缀的有效期、是否允许自动配置地址、在线(OnLink)状态可能各不相同， 所以需要使用多个 “<code>[IPv6Prefix]</code>“ 小节来分别配置多个不同的 IPv6 前缀。</p>
<p>PreferredLifetimeSec&#x3D;<code>, </code>ValidLifetimeSec<br>PreferredLifetimeSec&#x3D;<code>表示该IPv6前缀的首选生存期时长(单位是秒)，默认值是 604800 秒(一个星期)。</code>ValidLifetimeSec&#x3D;&#96; 表示该IPv6前缀的有效生存期时长(单位是秒)，默认值是 2592000 秒(30天)。</p>
<h5 id="14-Bridge"><a href="#14-Bridge" class="headerlink" title="14.Bridge"></a>14.Bridge</h5><p>可在 “<code>[Bridge]</code>“ 小节中使用的选项如下：</p>
<h6 id="UnicastFlood"><a href="#UnicastFlood" class="headerlink" title="UnicastFlood"></a>UnicastFlood</h6><p>接受一个布尔值。 设为 yes 表示网桥应该通过该端口转发没有FDB项并且目标MAC地址未知的流量。 若未设置此选项，则使用内核的默认值。</p>
<h6 id="MulticastToUnicast"><a href="#MulticastToUnicast" class="headerlink" title="MulticastToUnicast"></a>MulticastToUnicast</h6><p>接受一个布尔值。设置是否开启运行在网桥多播侦听功能之上的多播到单播。 这意味着单播副本只传递给对它感兴趣的主机。 若未设置此选项，则使用内核的默认值。</p>
<h6 id="HairPin"><a href="#HairPin" class="headerlink" title="HairPin"></a>HairPin</h6><p>接受一个布尔值。 设置网桥是否可以将从该端口接收到的流量仍然通过该端口返还发送回去。 若未设置此选项， 则使用内核的默认值。</p>
<h6 id="UseBPDU"><a href="#UseBPDU" class="headerlink" title="UseBPDU"></a>UseBPDU</h6><p>接受一个布尔值。设置该网桥端口是否处理 STP BPDU(Bridge Protocol Data Units)。 若未设置此选项，则使用内核的默认值。</p>
<h6 id="FastLeave"><a href="#FastLeave" class="headerlink" title="FastLeave"></a>FastLeave</h6><p>接受一个布尔值。 设置是否允许在该端口接收到”IGMP Leave”消息后立即停止此端口上的多播。 此选项仅与IGMP嗅探一起使用才有意义。若未设置此选项，则使用内核的默认值。</p>
<h6 id="AllowPortToBeRoot"><a href="#AllowPortToBeRoot" class="headerlink" title="AllowPortToBeRoot"></a>AllowPortToBeRoot</h6><p>接受一个布尔值。设置是否允许该端口成为根端口(Root Port)，也就是与根桥(Root Bridge)直接相连或路径最短的端口。 此选项仅在网桥启用了STP(生成树协议)的情况下才有意义。 若未设置此选项，则使用内核的默认值。</p>
<h6 id="Cost"><a href="#Cost" class="headerlink" title="Cost"></a>Cost</h6><p>设置该端口发送数据包的”cost”。 一个网桥上的不同端口可能有不同的速度， 速度越快的端口，其”cost”值也越低。 因此，”cost”值可用于决定使用哪个端口。 取值范围是 1 到 65535 之间的一个整数。</p>
<h6 id="Priority-1"><a href="#Priority-1" class="headerlink" title="Priority"></a>Priority</h6><p>设置该接口的”优先级”。 网桥上的每一个端口都可以拥有一个”优先级”，用于确定优先使用哪一个连接。 较小的数值表示优先级较高(更优先使用)。 可设为 0 到 63 之间的整数。 此选项没有默认值，意味着默认使用内核的值(默认为 32)。</p>
<h5 id="15-BridgeFDB"><a href="#15-BridgeFDB" class="headerlink" title="15.BridgeFDB"></a>15.BridgeFDB</h5><p>“<code>[BridgeFDB]</code>“ 小节 用于管理网桥端口的流量转发表。 可以通过设置多个 “<code>[BridgeFDB]</code>“ 小节 来配置多个静态MAC表项。</p>
<h6 id="MACAddress-3"><a href="#MACAddress-3" class="headerlink" title="MACAddress"></a>MACAddress</h6><p>这是一个必须设置的选项， 含义与 “<code>[Link]</code>“ 小节中的同名选项相同。</p>
<h6 id="VLANId"><a href="#VLANId" class="headerlink" title="VLANId"></a>VLANId</h6><p>新的静态MAC表项的”VLAN ID”。 若未设置， 则不添加任何”VLAN ID”信息。</p>
<h5 id="16-CAN"><a href="#16-CAN" class="headerlink" title="16.CAN"></a>16.CAN</h5><p>管理控制器区域网络(Controller Area Network)(CAN 总线)。 可在 “<code>[CAN]</code>“ 小节中使用的选项如下：</p>
<h6 id="BitRate"><a href="#BitRate" class="headerlink" title="BitRate"></a>BitRate</h6><p>CAN设备的比特率(位&#x2F;秒)。 可以使用以1000为基准的 SI 后缀(K, M)。</p>
<h6 id="SamplePoint"><a href="#SamplePoint" class="headerlink" title="SamplePoint"></a>SamplePoint</h6><p>可选的采样点小数点百分比(例如 “<code>75%</code>“, “<code>87.5%</code>“)。</p>
<h6 id="RestartSec"><a href="#RestartSec" class="headerlink" title="RestartSec"></a>RestartSec</h6><p>自动重启延迟。 设为非零值表示在总线断开的情况下，延迟指定的时长后自动触发CAN控制器重启。 可以使用表示时间单位的 “<code>s</code>“, “<code>ms</code>“, “<code>us</code>“ 后缀。设为 “<code>infinity</code>“ 或 “<code>0</code>“ 表示关闭自动重启。 默认为关闭自动重启。</p>
<h5 id="17-BridgeVLAN"><a href="#17-BridgeVLAN" class="headerlink" title="17.BridgeVLAN"></a>17.BridgeVLAN</h5><p>“<code>[BridgeVLAN]</code>“ 小节用于管理网桥端口的 VLAN ID 配置。 可以通过设置多个 “<code>[BridgeVLAN]</code>“ 小节来配置多个 VLAN 项。 此小节仅在 <a target="_blank" rel="noopener" href="http://www.jinbuguo.com/systemd/systemd.netdev.html#">systemd.netdev(5)</a> 中 “<code>[Bridge]</code>“ 小节下的 <code>VLANFiltering=</code> 选项被开启时才有意义。</p>
<h6 id="VLAN-1"><a href="#VLAN-1" class="headerlink" title="VLAN"></a>VLAN</h6><p>可以设为一个单独的 ID 或 “M-N” 格式表示的ID范围。表示在此端口上启用的 VLAN ID 。 有效的 VLAN ID 范围是 1~4094 。</p>
<h6 id="EgressUntagged"><a href="#EgressUntagged" class="headerlink" title="EgressUntagged"></a>EgressUntagged</h6><p>可以设为一个单独的 ID 或 “M-N” 格式表示的ID范围。 此处设置的 VLAN ID 将被用于在出口上 untag 帧。 设置此选项将会隐含的使用 <code>VLAN=</code> 并将 VLAN ID 同时应用于进入的帧。</p>
<h6 id="PVID"><a href="#PVID" class="headerlink" title="PVID"></a>PVID</h6><p>为所有进入的 untag 帧设置 Port VLAN ID 。此选项仅可使用一次。 设置此选项将会隐含的使用 <code>VLAN=</code> 并将 VLAN ID 同时应用于进入的帧。</p>
<h4 id="3-实例"><a href="#3-实例" class="headerlink" title="3.实例"></a>3.实例</h4><h6 id="1-指定网卡配置静态ip"><a href="#1-指定网卡配置静态ip" class="headerlink" title="1.指定网卡配置静态ip"></a>1.指定网卡配置静态ip</h6><p>&#x2F;etc&#x2F;systemd&#x2F;network&#x2F;50-static.network</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[Match]</span><br><span class="line">Name=enp2s0</span><br><span class="line"></span><br><span class="line">[Network]</span><br><span class="line">Address=192.168.0.15/24</span><br><span class="line">Gateway=192.168.0.1</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># /etc/systemd/network/80-dhcp.network</span><br><span class="line">[Match]</span><br><span class="line">Name=en*</span><br><span class="line"></span><br><span class="line">[Network]</span><br><span class="line">DHCP=yes</span><br></pre></td></tr></table></figure>
<h6 id="2-桥接网卡"><a href="#2-桥接网卡" class="headerlink" title="2.桥接网卡"></a>2.桥接网卡</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># /etc/systemd/network/25-bridge-static.network</span><br><span class="line">[Match]</span><br><span class="line">Name=bridge0</span><br><span class="line"></span><br><span class="line">[Network]</span><br><span class="line">Address=192.168.0.15/24</span><br><span class="line">Gateway=192.168.0.1</span><br><span class="line">DNS=192.168.0.1</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># /etc/systemd/network/25-bridge-slave-interface-1.network</span><br><span class="line">[Match]</span><br><span class="line">Name=enp2s0</span><br><span class="line"></span><br><span class="line">[Network]</span><br><span class="line">Bridge=bridge0</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># /etc/systemd/network/25-bridge-slave-interface-2.network</span><br><span class="line">[Match]</span><br><span class="line">Name=wlp3s0</span><br><span class="line"></span><br><span class="line">[Network]</span><br><span class="line">Bridge=bridge0</span><br></pre></td></tr></table></figure>
<p>创建一个网桥，并将 “<code>enp2s0</code>“ 与 “<code>wlp3s0</code>“ 添加进去。 同时为网桥配置一个静态地址，静态设置的网关也将被用作默认路由。 设置的DNS服务器将会被添加到全局DNS服务器列表中。</p>
<p>&#x2F;etc&#x2F;systemd&#x2F;network&#x2F;20-bridge-slave-interface-vlan.network<br>[Match]<br>Name&#x3D;enp2s0</p>
<p>[Network]<br>Bridge&#x3D;bridge0</p>
<p>[BridgeVLAN]<br>VLAN&#x3D;1-32<br>PVID&#x3D;42<br>EgressUntagged&#x3D;42</p>
<p>[BridgeVLAN]<br>VLAN&#x3D;100-200</p>
<p>[BridgeVLAN]<br>EgressUntagged&#x3D;300-400</p>
<p>本例的设置覆盖了上例中对 “<code>enp2s0</code>“ 接口的配置，为其开启了 VLAN 功能： (1) VLAN ID 等于 1-32, 42, 100-400 的包将被直接发出， (2) VLAN ID 等于 42, 300-400 的包将被去掉 tag 标记之后再发出。 (3) 接收到的无 tag 标记的包将被指定一个 VLAN ID 等于 42 的值。</p>
<h6 id="3-隧道配置"><a href="#3-隧道配置" class="headerlink" title="3.隧道配置"></a>3.隧道配置</h6><p>&#x2F;etc&#x2F;systemd&#x2F;network&#x2F;25-tunnels.network<br>[Match]<br>Name&#x3D;ens1</p>
<p>[Network]<br>Tunnel&#x3D;ipip-tun<br>Tunnel&#x3D;sit-tun<br>Tunnel&#x3D;gre-tun<br>Tunnel&#x3D;vti-tun</p>
<p>&#x2F;etc&#x2F;systemd&#x2F;network&#x2F;25-tunnel-ipip.netdev<br>[NetDev]<br>Name&#x3D;ipip-tun<br>Kind&#x3D;ipip</p>
<p>&#x2F;etc&#x2F;systemd&#x2F;network&#x2F;25-tunnel-sit.netdev<br>[NetDev]<br>Name&#x3D;sit-tun<br>Kind&#x3D;sit</p>
<p>&#x2F;etc&#x2F;systemd&#x2F;network&#x2F;25-tunnel-gre.netdev<br>[NetDev]<br>Name&#x3D;gre-tun<br>Kind&#x3D;gre</p>
<p>&#x2F;etc&#x2F;systemd&#x2F;network&#x2F;25-tunnel-vti.netdev<br>[NetDev]<br>Name&#x3D;vti-tun<br>Kind&#x3D;vti</p>
<p>这将启动 “<code>ens1</code>“ 接口，并使用此接口创建一个 IPIP 隧道、 一个 SIT 隧道、一个 GRE 隧道、一个 VTI 隧道。</p>
<h6 id="4-多网卡绑定"><a href="#4-多网卡绑定" class="headerlink" title="4.多网卡绑定"></a>4.多网卡绑定</h6><p>&#x2F;etc&#x2F;systemd&#x2F;network&#x2F;30-bond1.network<br>[Match]<br>Name&#x3D;bond1</p>
<p>[Network]<br>DHCP&#x3D;ipv6</p>
<p>&#x2F;etc&#x2F;systemd&#x2F;network&#x2F;30-bond1.netdev<br>[NetDev]<br>Name&#x3D;bond1<br>Kind&#x3D;bond</p>
<p>&#x2F;etc&#x2F;systemd&#x2F;network&#x2F;30-bond1-dev1.network<br>[Match]<br>MACAddress&#x3D;52:54:00:e9:64:41</p>
<p>[Network]<br>Bond&#x3D;bond1</p>
<p>&#x2F;etc&#x2F;systemd&#x2F;network&#x2F;30-bond1-dev2.network<br>[Match]<br>MACAddress&#x3D;52:54:00:e9:64:42</p>
<p>[Network]<br>Bond&#x3D;bond1</p>
<p>创建一个 “<code>bond1</code>“ 设备， 并将两个MAC地址为 52:54:00:e9:64:41 与 52:54:00:e9:64:42 的网卡添加进去。 同时使用 DHCPv6 来获取地址。</p>
<h6 id="5-虚拟路由转发-VRF"><a href="#5-虚拟路由转发-VRF" class="headerlink" title="5.虚拟路由转发(VRF)"></a>5.虚拟路由转发(VRF)</h6><p>将 “<code>bond1</code>“ 添加到 VRF 主接口 “<code>vrf1</code>“ 上。 这将把此接口上生成的路由重定向到创建 VFR 过程中定义的路由表中。 注意，Linux-4.8 之前的内核不会根据 VFR 路由表重定向流量，除非专门添加了特定的IP规则。</p>
<p>&#x2F;etc&#x2F;systemd&#x2F;network&#x2F;25-vrf.network<br>[Match]<br>Name&#x3D;bond1</p>
<p>[Network]<br>VRF&#x3D;vrf1</p>
<h6 id="6-MacVTap"><a href="#6-MacVTap" class="headerlink" title="6.MacVTap"></a>6.MacVTap</h6><p>启动 “<code>macvtap-test</code>“ 接口， 并将其附着到 “<code>enp0s25</code>“ 上。</p>
<p>&#x2F;usr&#x2F;lib&#x2F;systemd&#x2F;network&#x2F;25-macvtap.network<br>[Match]<br>Name&#x3D;enp0s25</p>
<p>[Network]<br>MACVTAP&#x3D;macvtap-test</p>
<h2 id="2-NetworkManager"><a href="#2-NetworkManager" class="headerlink" title="2.NetworkManager"></a>2.NetworkManager</h2><h3 id="1-描述-1"><a href="#1-描述-1" class="headerlink" title="1.描述"></a>1.描述</h3><p><a target="_blank" rel="noopener" href="https://networkmanager.dev/">NetworkManager</a> 是一个为系统提供检测和配置功能以便自动连接到网络的程序。NetworkManager 的功能对无线和有线网络都很有用。对于无线网络，NetworkManager 偏好已知的无线网络，并能切换到最可靠的网络。能感知 NetworkManager 的应用程序可以切换在线和离线模式。比起无线连接，NetworkManager 更偏好有线连接，且支持调制解调器连接和一些类型的 VPN。NetworkManager 最初由 Red Hat 开发，现在由 <a target="_blank" rel="noopener" href="https://wiki.archlinuxcn.org/wiki/GNOME" title="GNOME">GNOME</a> 管理。</p>
<h4 id="1-移动网络支持"><a href="#1-移动网络支持" class="headerlink" title="1.移动网络支持"></a>1.移动网络支持</h4><p><a target="_blank" rel="noopener" href="https://wiki.archlinuxcn.org/wiki/%E5%AE%89%E8%A3%85" title="安装">安装</a> <a target="_blank" rel="noopener" href="https://archlinux.org/packages/?name=modemmanager">modemmanager</a>包 和 <a target="_blank" rel="noopener" href="https://archlinux.org/packages/?name=usb_modeswitch">usb_modeswitch</a>包。然后<a target="_blank" rel="noopener" href="https://wiki.archlinuxcn.org/wiki/%E5%90%AF%E7%94%A8" title="启用">启用</a>并<a target="_blank" rel="noopener" href="https://wiki.archlinuxcn.org/wiki/%E5%90%AF%E5%8A%A8" title="启动">启动</a> <code>ModemManager.service</code>。<br>可能需要<a target="_blank" rel="noopener" href="https://wiki.archlinuxcn.org/wiki/Help:%E9%98%85%E8%AF%BB#%E6%8E%A7%E5%88%B6_systemd_%E5%8D%95%E5%85%83" title="Help:阅读">重新启动</a> <code>NetworkManager.service</code> 才能使其检测 ModemManager。重新启动后，重新插入调制解调器应该就可以识别了。</p>
<p>从前端界面(例如 <a target="_blank" rel="noopener" href="https://archlinux.org/packages/?name=nm-connection-editor">nm-connection-editor</a>包)添加连接并将连接类型选择为 broadband,选择 ISP 和套餐, <a target="_blank" rel="noopener" href="https://archlinux.org/packages/?name=mobile-broadband-provider-info">mobile-broadband-provider-info</a>包 会自动填入 <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Access_Point_Name" title="wikipedia:Access Point Name">APN</a> 和其它设置。</p>
<h4 id="2-PPPoE-DSL-支持"><a href="#2-PPPoE-DSL-支持" class="headerlink" title="2.PPPoE &#x2F; DSL 支持"></a>2.PPPoE &#x2F; DSL 支持</h4><p><a target="_blank" rel="noopener" href="https://wiki.archlinuxcn.org/wiki/%E5%AE%89%E8%A3%85" title="安装">安装</a> <a target="_blank" rel="noopener" href="https://archlinux.org/packages/?name=rp-pppoe">rp-pppoe</a>包 以支持 PPPoE &#x2F; DSL 连接。使用 <code>nm-connection-editor</code> 添加一个新的 DSL&#x2F;PPPoE 连接。</p>
<h4 id="3-VPN-支持"><a href="#3-VPN-支持" class="headerlink" title="3.VPN 支持"></a>3.VPN 支持</h4><p>从 1.16 版本开始 NetworkManager 原生支持 <a target="_blank" rel="noopener" href="https://wiki.archlinuxcn.org/wiki/WireGuard" title="WireGuard">WireGuard</a>，它只需要 <code>wireguard</code> 内核模块。详见 <a target="_blank" rel="noopener" href="https://blogs.gnome.org/thaller/2019/03/15/wireguard-in-networkmanager/">WireGuard in NetworkManager 博客文章</a>。</p>
<p>对其他类型 VPN 的支持基于一个插件系统。它们在以下软件包中提供：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://archlinux.org/packages/?name=networkmanager-openconnect">networkmanager-openconnect</a>包 支持 <a target="_blank" rel="noopener" href="https://wiki.archlinuxcn.org/wzh/index.php?title=OpenConnect&action=edit&redlink=1" title="OpenConnect（页面不存在）">OpenConnect</a></li>
<li><a target="_blank" rel="noopener" href="https://wiki.archlinuxcn.org/wzh/index.php?title=Networkmanager-openvpn&action=edit&redlink=1" title="Networkmanager-openvpn（页面不存在）">networkmanager-openvpn</a> 支持 <a target="_blank" rel="noopener" href="https://wiki.archlinuxcn.org/wiki/OpenVPN" title="OpenVPN">OpenVPN</a></li>
<li><a target="_blank" rel="noopener" href="https://archlinux.org/packages/?name=networkmanager-pptp">networkmanager-pptp</a>包 支持 <a target="_blank" rel="noopener" href="https://wiki.archlinuxcn.org/wiki/PPTP_Client" title="PPTP Client">PPTP Client</a></li>
<li><a target="_blank" rel="noopener" href="https://archlinux.org/packages/?name=networkmanager-strongswan">networkmanager-strongswan</a>包 支持 <a target="_blank" rel="noopener" href="https://wiki.archlinuxcn.org/wiki/StrongSwan" title="StrongSwan">strongSwan</a></li>
<li><a target="_blank" rel="noopener" href="https://archlinux.org/packages/?name=networkmanager-vpnc">networkmanager-vpnc</a>包</li>
<li><a target="_blank" rel="noopener" href="https://aur.archlinux.org/packages/networkmanager-fortisslvpn-git/">networkmanager-fortisslvpn-git</a>AUR</li>
<li><a target="_blank" rel="noopener" href="https://aur.archlinux.org/packages/networkmanager-iodine-git/">networkmanager-iodine-git</a>AUR</li>
<li><a target="_blank" rel="noopener" href="https://aur.archlinux.org/packages/networkmanager-libreswan/">networkmanager-libreswan</a>AUR</li>
<li><a target="_blank" rel="noopener" href="https://archlinux.org/packages/?name=networkmanager-l2tp">networkmanager-l2tp</a>包</li>
<li><a target="_blank" rel="noopener" href="https://aur.archlinux.org/packages/networkmanager-ssh-git/">networkmanager-ssh-git</a>AUR</li>
<li><a target="_blank" rel="noopener" href="https://archlinux.org/packages/?name=network-manager-sstp">network-manager-sstp</a>包</li>
</ul>
<h4 id="4-GUI界面"><a href="#4-GUI界面" class="headerlink" title="4.GUI界面"></a>4.GUI界面</h4><ul>
<li><a target="_blank" rel="noopener" href="https://archlinux.org/packages/?name=nm-connection-editor">nm-connection-editor</a>包 提供图形界面；</li>
<li><a target="_blank" rel="noopener" href="https://archlinux.org/packages/?name=network-manager-applet">network-manager-applet</a>包 提供系统托盘图标（<code>nm-applet</code>）。</li>
</ul>
<h3 id="2-安装"><a href="#2-安装" class="headerlink" title="2.安装"></a>2.安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo pacman -S networkmanager</span><br><span class="line"><span class="comment">#此软件包包含一个守护程序、一个命令行界面（`nmcli`）和一个基于 curses 的界面（`nmtui`）。</span></span><br></pre></td></tr></table></figure>

<h3 id="3-使用"><a href="#3-使用" class="headerlink" title="3.使用"></a>3.使用</h3><h4 id="1-nmcli"><a href="#1-nmcli" class="headerlink" title="1.nmcli"></a>1.nmcli</h4><h5 id="1-常用的命令"><a href="#1-常用的命令" class="headerlink" title="1.常用的命令"></a>1.常用的命令</h5><p>1.显示附近的 Wi-Fi 网络</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmcli device wifi list</span><br></pre></td></tr></table></figure>

<p>2.连接到 Wi-Fi 网络</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmcli device wifi connect _SSID_或_BSSID_ password _密码_</span><br></pre></td></tr></table></figure>

<p>3.连接到隐藏的 Wi-Fi 网络</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmcli device wifi connect _SSID_或_BSSID_ password _密码_ hidden <span class="built_in">yes</span></span><br></pre></td></tr></table></figure>

<p>4.连接到 <code>wlan1</code> 网络接口上的 Wi-Fi</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmcli device wifi connect _SSID_或_BSSID_ password _密码_ ifname wlan1 _profile_name_</span><br></pre></td></tr></table></figure>

<p>5.断开网络接口上的连接</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmcli device disconnect ifname eth0</span><br></pre></td></tr></table></figure>

<p>6.显示连接列表及其名称、UUID、类型和支持设备</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmcli connection show</span><br></pre></td></tr></table></figure>

<p>7.激活连接（即使用现有配置文件连接到网络）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmcli connection up _name_或_uuid_</span><br></pre></td></tr></table></figure>

<p>8.删除连接</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmcli connection delete _name_或_uuid_</span><br></pre></td></tr></table></figure>

<p>9.显示所有网络设备及其状态</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmcli device</span><br></pre></td></tr></table></figure>

<p>10.关闭 Wi-Fi</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmcli radio wifi off</span><br></pre></td></tr></table></figure>

<h5 id="2-编辑连接"><a href="#2-编辑连接" class="headerlink" title="2.编辑连接"></a>2.编辑连接</h5><p>1.获取连接列表</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmcli connection</span><br></pre></td></tr></table></figure>

<p>2.nmcli交互式编辑器</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`nmcli connection edit <span class="string">&#x27;Wired connection 2&#x27;</span>`.</span><br></pre></td></tr></table></figure>

<p>3.nmcli命令行界面</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmcli connection modify <span class="string">&#x27;Wired connection 2&#x27;</span> _setting_._property_ _value_</span><br></pre></td></tr></table></figure>

<p>连接文件<br>&#x2F;etc&#x2F;NetworkManager&#x2F;system-connections&#x2F;<br>4.重载连接文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmcli connection reload</span><br></pre></td></tr></table></figure>
<h4 id="2-nmtui"><a href="#2-nmtui" class="headerlink" title="2.nmtui"></a>2.nmtui</h4><p>nmtui为networkmanager的交互式图形化管理工具</p>
<h2 id="3-iwd"><a href="#3-iwd" class="headerlink" title="3.iwd"></a>3.iwd</h2><h3 id="1-描述-2"><a href="#1-描述-2" class="headerlink" title="1.描述"></a>1.描述</h3><p><a target="_blank" rel="noopener" href="https://iwd.wiki.kernel.org/">iwd</a> (iNet wireless daemon，iNet 无线守护程序) 是由英特尔（Intel）为 Linux 编写的一个无线网络守护程序。该项目的核心目标是不依赖任何外部库，而是最大程度地利用 Linux 内核提供的功能来优化资源利用。</p>
<p>iwd 可以独立工作，也可以和 <a target="_blank" rel="noopener" href="https://wiki.archlinuxcn.org/wiki/ConnMan" title="ConnMan">ConnMan</a>、<a target="_blank" rel="noopener" href="https://wiki.archlinuxcn.org/wiki/Systemd-networkd" title="Systemd-networkd">systemd-networkd</a> 和 <a target="_blank" rel="noopener" href="https://wiki.archlinuxcn.org/wiki/NetworkManager#Using_iwd_as_the_Wi-Fi_backend" title="NetworkManager">NetworkManager</a> 这样更完善的网络管理器结合使用。</p>
<h3 id="2-安装-1"><a href="#2-安装-1" class="headerlink" title="2.安装"></a>2.安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pacman -S iwd</span><br><span class="line"><span class="comment">#iwd软件包 软件包提供了客户端程序 `iwctl`、守护程序 `iwd` 和 WiFi 监控工具 `iwmon`</span></span><br><span class="line"><span class="comment">#[iwgtk]CNRepo 提供 iwd 的 GUI 前端和托盘图标。</span></span><br></pre></td></tr></table></figure>
<h3 id="3-使用-1"><a href="#3-使用-1" class="headerlink" title="3.使用"></a>3.使用</h3><h4 id="1-iwctl"><a href="#1-iwctl" class="headerlink" title="1.iwctl"></a>1.iwctl</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#进入交互式命令行</span></span><br><span class="line">iwctl</span><br><span class="line"></span><br><span class="line"><span class="comment">#查看帮助</span></span><br><span class="line">[iwd]<span class="comment"># help</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#首先，如果不知道你的网络设备名称，请列出所有 WiFi 设备：</span></span><br><span class="line">[iwd]<span class="comment"># device list</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#然后，要开始扫描网络（注意：这个命令不会输出任何内容），执行：</span></span><br><span class="line">[iwd]<span class="comment"># station device scan</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#再然后，就可以列出所有可用的网络：</span></span><br><span class="line">[iwd]<span class="comment"># station device get-networks</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#最后，要连接到一个网络</span></span><br><span class="line">[iwd]<span class="comment"># station device connect SSID</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#如果要求输入网络密码，将会提示用户输入。此外，连接操作可以应用成命令行参数的形式：</span></span><br><span class="line">iwctl --passphrase passphrase station device connectSSID</span><br><span class="line"></span><br><span class="line"><span class="comment">#要断开网络连接：</span></span><br><span class="line">[iwd]<span class="comment"># station device disconnect</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#要显示 WiFi 设备详细情况，比如 MAC 地址：</span></span><br><span class="line">[iwd]<span class="comment"># device device show</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#要显示包括 WiFi 设备的连接网络在内的连接状态：</span></span><br><span class="line">[iwd]<span class="comment"># station device show</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#要列出以前连接过的网络：</span></span><br><span class="line">[iwd]<span class="comment"># known-networks list</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#要忘记已知的网络：</span></span><br><span class="line">[iwd]<span class="comment"># known-networks SSID forget</span></span><br></pre></td></tr></table></figure>
<h2 id="4-wpa-supplicant"><a href="#4-wpa-supplicant" class="headerlink" title="4.wpa_supplicant"></a>4.wpa_supplicant</h2><h3 id="1-描述-3"><a href="#1-描述-3" class="headerlink" title="1.描述"></a>1.描述</h3><p><a target="_blank" rel="noopener" href="https://hostap.epitest.fi/wpa_supplicant/">wpa_supplicant</a> 是跨平台的 WPA <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Supplicant_(computer)" title="wikipedia:Supplicant (computer)">请求者程序（supplicant）</a>，支持 WEP、WPA 和 WPA2(<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/IEEE_802.11i-2004" title="wikipedia:IEEE 802.11i-2004">IEEE 802.11i</a>).。可以在桌面、笔记本甚至嵌入式系统中使用。</p>
<h3 id="2-安装-2"><a href="#2-安装-2" class="headerlink" title="2.安装"></a>2.安装</h3><p><a target="_blank" rel="noopener" href="https://wiki.archlinuxcn.org/wiki/%E5%AE%89%E8%A3%85" title="安装">安装</a> <a target="_blank" rel="noopener" href="https://archlinux.org/packages/?name=wpa_supplicant">wpa_supplicant</a>包 软件包。此软件包提供了主程序 _wpa_supplicant_，密码工具 <em>wpa_passphrase</em> 和文字界面前端 <em>wpa_cli</em>.</p>
<p>此外软件包 <a target="_blank" rel="noopener" href="https://aur.archlinux.org/packages/wpa_supplicant_gui/">wpa_supplicant_gui</a>AUR 提供了图形界面 _wpa_gui_。 <a target="_blank" rel="noopener" href="https://aur.archlinux.org/packages/wpa-cute/">wpa-cute</a>AUR 是 <em>wpa_gui</em> 的一个分支，提供了额外的修正和改进。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pacman -S wpa_supplicant</span><br></pre></td></tr></table></figure>
<h3 id="3-使用-2"><a href="#3-使用-2" class="headerlink" title="3.使用"></a>3.使用</h3><p>配置文件<br>&#x2F;etc&#x2F;wpa_supplicant&#x2F;wpa_supplicant.conf</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ctrl_interface=/run/wpa_supplicant</span><br><span class="line">update_config=1</span><br></pre></td></tr></table></figure>
<p>连接网络</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wpa_supplicant -B -i _interface_ -c /etc/wpa_supplicant/wpa_supplicant.conf</span><br></pre></td></tr></table></figure>
<p>生成配置文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wpa_passphrase MYSSID passphrase &gt; /etc/wpa_supplicant/example.conf</span><br></pre></td></tr></table></figure>
<h2 id="5-dhcpcd"><a href="#5-dhcpcd" class="headerlink" title="5.dhcpcd"></a>5.dhcpcd</h2><h3 id="1-描述-4"><a href="#1-描述-4" class="headerlink" title="1.描述"></a>1.描述</h3><p><em>hcpcd</em> 是 DHCP 和 DHCPv6 客户端，是目前功能最丰富的开源 DHCP 客户端。<a target="_blank" rel="noopener" href="https://roy.marples.name/projects/dhcpcd">项目主页</a>包含了完整的功能列表。</p>
<h3 id="2-安装-3"><a href="#2-安装-3" class="headerlink" title="2.安装"></a>2.安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pacman -S dhcpcd</span><br></pre></td></tr></table></figure>
<h3 id="3-使用-3"><a href="#3-使用-3" class="headerlink" title="3.使用"></a>3.使用</h3><h4 id="1-获取ip地址"><a href="#1-获取ip地址" class="headerlink" title="1.获取ip地址"></a>1.获取ip地址</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#获取ip地址</span></span><br><span class="line">dhcpcd</span><br></pre></td></tr></table></figure>
<h4 id="2-设置静态IP地址"><a href="#2-设置静态IP地址" class="headerlink" title="2. 设置静态IP地址"></a>2. 设置静态IP地址</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">/etc/dhcpcd.conf</span><br><span class="line"></span><br><span class="line">interface eth0</span><br><span class="line">static ip_address=192.168.0.10/24	</span><br><span class="line">static routers=192.168.0.1</span><br><span class="line">static domain_name_servers=192.168.0.1 8.8.8.8</span><br></pre></td></tr></table></figure>
<h4 id="3-设置回落地址"><a href="#3-设置回落地址" class="headerlink" title="3.设置回落地址"></a>3.设置回落地址</h4><p>在dhcp续约失败时，会启用此ip配置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">/etc/dhcpcd.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># define static profile</span></span><br><span class="line">profile static_eth0</span><br><span class="line">static ip_address=192.168.1.23/24</span><br><span class="line">static routers=192.168.1.1</span><br><span class="line">static domain_name_servers=192.168.1.1</span><br><span class="line"></span><br><span class="line"><span class="comment"># fallback to static profile on eth0</span></span><br><span class="line">interface _eth0_</span><br><span class="line">fallback static_eth0</span><br></pre></td></tr></table></figure>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">404NotFound</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://bugprogram-git.github.io/2023/01/07/Linux%E7%BD%91%E7%BB%9C%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7/">https://bugprogram-git.github.io/2023/01/07/Linux%E7%BD%91%E7%BB%9C%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">404NotFound</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            <span class="chip bg-color">无标签</span>
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    
        <link rel="stylesheet" href="/libs/gitalk/gitalk.css">
<link rel="stylesheet" href="/css/my-gitalk.css">

<div class="card gitalk-card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; padding-left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>评论</span>
    </div>
    <div id="gitalk-container" class="card-content"></div>
</div>

<script src="/libs/gitalk/gitalk.min.js"></script>
<script>
    let gitalk = new Gitalk({
        clientID: '',
        clientSecret: '',
        repo: '',
        owner: '',
        admin: null,
        id: '2023-01-07T09-42-55',
        distractionFreeMode: false  // Facebook-like distraction free mode
    });

    gitalk.render('gitalk-container');
</script>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2023/02/07/cmake%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/20.jpg" class="responsive-img" alt="cmake基本使用">
                        
                        <span class="card-title">cmake基本使用</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2023-02-07
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            404NotFound
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2022/12/22/%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E5%8F%8A%E9%85%8D%E7%BD%AE%E6%95%99%E7%A8%8B/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/3.jpg" class="responsive-img" alt="科学上网技术原理和及配置教程">
                        
                        <span class="card-title">科学上网技术原理和及配置教程</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2022-12-22
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E8%BD%AF%E4%BB%B6%E9%85%8D%E7%BD%AE/" class="post-category">
                                    软件配置
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/">
                        <span class="chip bg-color">科学上网</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>


  <!-- 是否加载使用自带的 prismjs. -->
  <script type="text/javascript" src="/libs/prism/prism.min.js"></script>


<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="503838841"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="/libs/aplayer/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 15px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2023-2024</span>
            
            <a href="/about" target="_blank">404NotFound</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            
                <span id="translate">|&nbsp;繁/简：</span><a id="translateLink" href="javascript:translatePage();">繁</a>
            
            <br>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
                <span id="sitetime"> Loading ...</span>
                <script>
                    var calcSiteTime = function () {
                        var seconds = 1000;
                        var minutes = seconds * 60;
                        var hours = minutes * 60;
                        var days = hours * 24;
                        var years = days * 365;
                        var today = new Date();
                        var startYear = "2023";
                        var startMonth = "8";
                        var startDate = "28";
                        var startHour = "0";
                        var startMinute = "0";
                        var startSecond = "0";
                        var todayYear = today.getFullYear();
                        var todayMonth = today.getMonth() + 1;
                        var todayDate = today.getDate();
                        var todayHour = today.getHours();
                        var todayMinute = today.getMinutes();
                        var todaySecond = today.getSeconds();
                        var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                        var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                        var diff = t2 - t1;
                        var diffYears = Math.floor(diff / years);
                        var diffDays = Math.floor((diff / days) - diffYears * 365);

                        // 区分是否有年份.
                        var language = 'zh-CN';
                        if (startYear === String(todayYear)) {
                            document.getElementById("year").innerHTML = todayYear;
                            var daysTip = 'This site has been running for ' + diffDays + ' days';
                            if (language === 'zh-CN') {
                                daysTip = '本站已运行 ' + diffDays + ' 天';
                            } else if (language === 'zh-HK') {
                                daysTip = '本站已運行 ' + diffDays + ' 天';
                            }
                            document.getElementById("sitetime").innerHTML = daysTip;
                        } else {
                            document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                            var yearsAndDaysTip = 'This site has been running for ' + diffYears + ' years and '
                                + diffDays + ' days';
                            if (language === 'zh-CN') {
                                yearsAndDaysTip = '本站已运行 ' + diffYears + ' 年 ' + diffDays + ' 天';
                            } else if (language === 'zh-HK') {
                                yearsAndDaysTip = '本站已運行 ' + diffYears + ' 年 ' + diffDays + ' 天';
                            }
                            document.getElementById("sitetime").innerHTML = yearsAndDaysTip;
                        }
                    }

                    calcSiteTime();
                </script>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/bugprogram-git" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:2066854113@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=2066854113" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 2066854113" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 白天和黑夜主题 -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    
        <!-- <script src='https://unpkg.com/mermaid@latest/dist/mermaid.min.js'></script> -->
        <script src='/libs/mermaid/mermaid.min.js'></script>
        <script>
          if (window.mermaid) {
            mermaid.initialize({theme: 'forest'});
          }
        </script>
    

    
        <script type="text/javascript" src="/js/tw_cn.js"></script>
        <script type="text/javascript">
          var defaultEncoding = 2; //网站编写字体是否繁体，1-繁体，2-简体
          var translateDelay = 0; //延迟时间,若不在前, 要设定延迟翻译时间, 如100表示100ms,默认为0
          var cookieDomain = "https://bugprogram-git.github.io"; //Cookie地址, 一定要设定, 通常为你的网址
          var msgToTraditionalChinese = "繁"; //此处可以更改为你想要显示的文字
          var msgToSimplifiedChinese = "简"; //同上，但两处均不建议更改
          var translateButtonId = "translateLink"; //默认互换id
          translateInitilization();
        </script>
    
    
    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
     
        <script type="text/javascript">
            // 只在桌面版网页启用特效
            var windowWidth = $(window).width();
            if (windowWidth > 768) {
                document.write('<script type="text/javascript" src="/libs/others/star.js"><\/script>');
            }
        </script>
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

<script>
    var _hmt = _hmt || [];
    (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
